# Layer 2 (Sentence Level) Sub-Step System Design
# ç¬¬2å±‚ï¼ˆå¥å­çº§ï¼‰å­æ­¥éª¤ç³»ç»Ÿè®¾è®¡

> Version: 1.0
> Date: 2026-01-08
> Purpose: Design comprehensive sub-step workflow for sentence-level De-AIGC processing within paragraph context
> ç›®çš„ï¼šè®¾è®¡åœ¨æ®µè½ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œå¥å­çº§De-AIGCå¤„ç†çš„å®Œæ•´å­æ­¥éª¤å·¥ä½œæµç¨‹

---

## ä¸€ã€è®¾è®¡æ¦‚è¿° | Design Overview

### 1.1 å±‚çº§å®šä½ | Layer Positioning

```
Layer 5: Document (æ–‡ç« å±‚)     â†’ Step 1.x series âœ… å·²å®ç°
Layer 4: Section (ç« èŠ‚å±‚)      â†’ Step 2.x series âœ… å·²å®ç°
Layer 3: Paragraph (æ®µè½å±‚)    â†’ Step 3.x series âœ… å·²å®ç°
Layer 2: Sentence (å¥å­å±‚)     â†’ Step 4.x series ğŸ“‹ æœ¬æ–‡æ¡£è®¾è®¡
Layer 1: Lexical (è¯æ±‡å±‚)      â†’ Step 5.x series
```

### 1.2 Layer 2 æ ¸å¿ƒè®¾è®¡ç†å¿µ | Core Design Philosophy

**é‡è¦åŸåˆ™**ï¼šLayer 2 **ä¸æ˜¯**å•ç‹¬åˆ†ææŸä¸€ä¸ªå¥å­ï¼Œè€Œæ˜¯**åœ¨æ®µè½çš„å°ºåº¦ä¸Š**åˆ†ææ¯ä¸ªå¥å­çš„ï¼š
- å¥å¼ï¼ˆç®€å•å¥/å¤åˆå¥/å¤æ‚å¥ï¼‰
- é€»è¾‘ï¼ˆå› æœ/å¯¹æ¯”/é€’è¿›ç­‰å…³ç³»ï¼‰
- é•¿çŸ­ï¼ˆåœ¨æ®µè½å†…çš„é•¿åº¦å˜åŒ–ï¼‰
- æ¡†æ¶ï¼ˆä¸»è°“å®¾/å€’è£…/è¢«åŠ¨ç­‰ï¼‰

**æ ¸å¿ƒæ“ä½œ**ï¼š
| æ“ä½œç±»å‹ | è¯´æ˜ Description | ç›®æ ‡ Goal |
|---------|-----------------|----------|
| **å¢åŠ å¥å¼å¤šæ ·æ€§** | æ‰“ç ´ SVO å•ä¸€æ¨¡å¼ | é™ä½å¥å¼æ£€æµ‹ç‡ |
| **è°ƒæ•´å¥å­** | å˜æ¢å¥å­å¼€å¤´ã€è¯­æ€ã€è¯­åº | å¢åŠ éšæœºæ€§ |
| **åˆå¹¶å¥å­** | å°†è¯­ä¹‰ç›¸è¿‘çš„çŸ­å¥åˆå¹¶ä¸ºå¤æ‚é•¿å¥ï¼ˆåµŒå¥—ä»å¥ï¼‰ | å¢åŠ å¥é•¿å˜å¼‚ |
| **æ‹†åˆ†å¥å­** | å°†è¿‡é•¿çš„å¥å­æ‹†åˆ†ä¸ºçŸ­å¥ | å¢åŠ èŠ‚å¥å˜åŒ– |
| **ä¿®æ­£æ˜¾æ€§è¿æ¥è¯** | åˆ é™¤æˆ–æ›¿æ¢ Furthermore/Moreover ç­‰ | é™ä½è¿æ¥è¯æ£€æµ‹ |

### 1.3 ä¸ç›¸é‚»å±‚çš„å…³ç³» | Relationship with Adjacent Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Layer 3 (Paragraph)                           â”‚
â”‚  â”œâ”€â”€ ä¼ å…¥: paragraphs[], paragraph_roles[]                          â”‚
â”‚  â”œâ”€â”€ ä¼ å…¥: paragraph_coherence[], sentence_length_cvs[]             â”‚
â”‚  â””â”€â”€ ä¼ å…¥: anchor_densities[], transition_issues[]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Layer 2 (Sentence)                              â”‚
â”‚  â”œâ”€â”€ æ¥æ”¶: æ®µè½ä¸Šä¸‹æ–‡ (roles, coherence, anchors, lengths)           â”‚
â”‚  â”œâ”€â”€ åˆ†æ: æ®µè½å†…çš„å¥å­å¥å¼ã€é•¿çŸ­ã€é€»è¾‘ã€æ¡†æ¶                          â”‚
â”‚  â”œâ”€â”€ æ“ä½œ: åˆå¹¶ã€æ‹†åˆ†ã€è°ƒæ•´ã€å¤šæ ·åŒ–                                   â”‚
â”‚  â””â”€â”€ ä¼ å‡º: sentence_context â†’ Layer 1                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Layer 1 (Lexical)                             â”‚
â”‚  â”œâ”€â”€ æ¥æ”¶: sentence_context (patterns, lengths, connectors)         â”‚
â”‚  â””â”€â”€ åˆ†æ: è¯æ±‡é€‰æ‹©ã€æ›¿æ¢ã€å¤šæ ·åŒ–                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æ£€æµ‹èƒ½åŠ›æ±‡æ€» | Detection Capabilities Summary

### 2.1 AIå¥å­ç‰¹å¾æ£€æµ‹ | AI Sentence Pattern Detection

| æ£€æµ‹ç»´åº¦ Dimension | AIç‰¹å¾ AI Pattern | äººç±»ç‰¹å¾ Human Pattern | æ£€æµ‹æ–¹æ³• Method |
|-------------------|-------------------|----------------------|----------------|
| **å¥å¼ç±»å‹åˆ†å¸ƒ** | ç®€å•å¥(SVO)å æ¯”>70% | å¥å¼ç±»å‹å‡è¡¡ | å¥æ³•è§£æ |
| **å¥é•¿å˜å¼‚ç³»æ•°** | æ®µå†…CV < 0.25 | æ®µå†…CV â‰¥ 0.35 | ç»Ÿè®¡è®¡ç®— |
| **å¥é¦–è¯æ±‡é‡å¤** | ç›¸åŒå¼€å¤´è¯>30% | å¼€å¤´å¤šæ · | è¯é¢‘ç»Ÿè®¡ |
| **è¿æ¥è¯å¯†åº¦** | æ˜¾æ€§è¿æ¥è¯>40% | éšæ€§æˆ–æ— è¿æ¥ | æ¨¡å¼åŒ¹é… |
| **ä»å¥åµŒå¥—æ·±åº¦** | å¹³å‡<1.2å±‚ | å¹³å‡â‰¥1.5å±‚ | å¥æ³•è§£æ |
| **è¢«åŠ¨å¥æ¯”ä¾‹** | <10% | 15-30% | è¯­æ€æ£€æµ‹ |
| **å€’è£…å¥æ¯”ä¾‹** | <5% | 5-15% | å¥å¼æ£€æµ‹ |
| **å¹³è¡Œç»“æ„** | è¿‡åº¦ä½¿ç”¨ | é€‚åº¦ä½¿ç”¨ | æ¨¡å¼æ£€æµ‹ |

### 2.2 å¥å¼ç±»å‹å®šä¹‰ | Sentence Type Definitions

| å¥å¼ç±»å‹ Type | è‹±æ–‡ English | ç»“æ„ Structure | ç¤ºä¾‹ Example |
|--------------|--------------|---------------|--------------|
| ç®€å•å¥ | Simple | S + V (+ O) | "The study shows results." |
| å¹¶åˆ—å¥ | Compound | S+V, conj S+V | "The study shows results, and the data confirms it." |
| å¤æ‚å¥ | Complex | Main + Subordinate | "Although the results vary, the trend is clear." |
| å¤åˆå¤æ‚å¥ | Compound-Complex | Multiple clauses | "While A affects B, C remains stable, which suggests D." |

### 2.3 æ£€æµ‹æŒ‡æ ‡é˜ˆå€¼ | Detection Metric Thresholds

#### 2.3.1 å¥å¼åˆ†å¸ƒæŒ‡æ ‡ | Sentence Pattern Metrics

| æŒ‡æ ‡ Metric | AIç‰¹å¾é˜ˆå€¼ | äººç±»ç‰¹å¾ç›®æ ‡ | è¯´æ˜ |
|------------|-----------|-------------|------|
| ç®€å•å¥æ¯”ä¾‹ | > 70% | 40-60% | Simple sentence ratio |
| å¹¶åˆ—å¥æ¯”ä¾‹ | < 15% | 15-25% | Compound sentence ratio |
| å¤æ‚å¥æ¯”ä¾‹ | < 10% | 20-35% | Complex sentence ratio |
| å¤åˆå¤æ‚å¥æ¯”ä¾‹ | < 5% | 10-20% | Compound-complex ratio |

#### 2.3.2 å¥é•¿åˆ†å¸ƒæŒ‡æ ‡ | Sentence Length Metrics

| æŒ‡æ ‡ Metric | AIç‰¹å¾é˜ˆå€¼ | äººç±»ç‰¹å¾ç›®æ ‡ | è¯´æ˜ |
|------------|-----------|-------------|------|
| æ®µå†…å¥é•¿CV | < 0.25 | â‰¥ 0.35 | å¥å­é•¿åº¦å˜å¼‚ç³»æ•° |
| æœ€çŸ­å¥ | > 12è¯ | â‰¤ 8è¯ | ç¼ºå°‘å¼ºè°ƒæ€§çŸ­å¥ |
| æœ€é•¿å¥ | < 30è¯ | â‰¥ 35è¯ | ç¼ºå°‘å¤æ‚é•¿å¥ |
| Burstiness | < 0.3 | â‰¥ 0.4 | å¥é•¿çªå‘æ€§ |

#### 2.3.3 å¥é¦–å¤šæ ·æ€§æŒ‡æ ‡ | Sentence Opener Metrics

| æŒ‡æ ‡ Metric | AIç‰¹å¾é˜ˆå€¼ | äººç±»ç‰¹å¾ç›®æ ‡ | è¯´æ˜ |
|------------|-----------|-------------|------|
| å¼€å¤´è¯é‡å¤ç‡ | > 30% | < 20% | åŒä¸€å¼€å¤´è¯å‡ºç°é¢‘ç‡ |
| ä¸»è¯­å¼€å¤´æ¯”ä¾‹ | > 80% | < 65% | ä»¥ä¸»è¯­å¼€å¤´çš„å¥å­ |
| Theå¼€å¤´æ¯”ä¾‹ | > 40% | < 25% | "The..." å¼€å¤´å¥å­ |
| This/Theseå¼€å¤´ | > 25% | < 15% | æŒ‡ç¤ºä»£è¯å¼€å¤´ |

#### 2.3.4 è¿æ¥è¯æŒ‡æ ‡ | Connector Metrics

| æŒ‡æ ‡ Metric | AIç‰¹å¾é˜ˆå€¼ | äººç±»ç‰¹å¾ç›®æ ‡ | è¯´æ˜ |
|------------|-----------|-------------|------|
| æ˜¾æ€§è¿æ¥è¯æ¯”ä¾‹ | > 40% | < 25% | Furthermore/Moreoverç­‰ |
| å¥é¦–è¿æ¥è¯ | > 35% | < 20% | å¥å­ä»¥è¿æ¥è¯å¼€å¤´ |
| è¿æ¥è¯ç±»å‹å•ä¸€ | < 3ç§ | â‰¥ 5ç§ | è¿æ¥è¯å¤šæ ·æ€§ |

---

## ä¸‰ã€å­æ­¥éª¤è®¾è®¡æ–¹æ¡ˆ | Sub-Step Design Proposal

### 3.0 æ‰§è¡Œæµç¨‹å›¾ | Execution Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Layer 2: Sentence Level Analysis                          â”‚
â”‚                    å¥å­çº§åˆ†æï¼ˆåŸºäºæ®µè½ä¸Šä¸‹æ–‡ï¼Œéå­¤ç«‹åˆ†æï¼‰                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Step 4.0: å¥å­è¯†åˆ«ä¸æ ‡æ³¨ (Sentence Identification & Labeling)     â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ¥æ”¶æ®µè½ä¸Šä¸‹æ–‡ Receive paragraph context from Layer 3        â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ åˆ†å‰²æ®µè½ä¸ºå¥å­ Split paragraphs into sentences               â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ ‡æ³¨å¥å­ç±»å‹å’ŒåŠŸèƒ½ Label sentence type and function          â”‚     â”‚
â”‚  â”‚  â””â”€â”€ ç”Ÿæˆæ®µè½-å¥å­æ˜ å°„ Generate paragraph-sentence mapping        â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  æ£€æµ‹å™¨ï¼šSentenceSegmenter + SyntaxParser                          â”‚     â”‚
â”‚  â”‚  è¾“å‡ºï¼šsentences[] + sentence_types[] + paragraph_sentence_map     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Step 4.1: å¥å¼ç»“æ„åˆ†æ (Sentence Pattern Analysis)                â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ åˆ†æå¥å¼ç±»å‹åˆ†å¸ƒ Analyze sentence type distribution          â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ£€æµ‹å¥å¼é‡å¤ç‡ Detect pattern repetition rate                â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ£€æµ‹å¥é¦–è¯æ±‡é‡å¤ Detect sentence opener repetition           â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ åˆ†æè¯­æ€åˆ†å¸ƒï¼ˆä¸»åŠ¨/è¢«åŠ¨ï¼‰Analyze voice distribution          â”‚     â”‚
â”‚  â”‚  â””â”€â”€ æ£€æµ‹ä»å¥åµŒå¥—æ·±åº¦ Detect subordinate clause depth             â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  æ£€æµ‹é¡¹ï¼šå¥å¼å•ä¸€æ€§ã€å¥é¦–é‡å¤ã€è¯­æ€å•è°ƒ                             â”‚     â”‚
â”‚  â”‚  æ£€æµ‹å™¨ï¼šSyntaxPatternAnalyzer (Rule-based + NLP)                  â”‚     â”‚
â”‚  â”‚  è¾“å‡ºï¼špattern_distribution{}, opener_issues[], voice_issues[]     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Step 4.2: æ®µå†…å¥é•¿åˆ†æä¸ä¼˜åŒ– (In-Paragraph Length Analysis)       â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ è®¡ç®—æ¯æ®µå†…çš„å¥é•¿åˆ†å¸ƒ Calculate length distribution per para  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ£€æµ‹å¥é•¿å‡åŒ€æ€§ Detect length uniformity (CV < 0.25)         â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ£€æµ‹ç¼ºå¤±çš„çŸ­å¥/é•¿å¥ Detect missing short/long sentences     â”‚     â”‚
â”‚  â”‚  â””â”€â”€ ç”Ÿæˆåˆå¹¶/æ‹†åˆ†å€™é€‰ Generate merge/split candidates           â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  æ£€æµ‹é¡¹ï¼šå¥é•¿è¿‡äºå‡åŒ€ã€ç¼ºå°‘èŠ‚å¥å˜åŒ–                                 â”‚     â”‚
â”‚  â”‚  æ£€æµ‹å™¨ï¼šSentenceLengthAnalyzer (Statistical)                      â”‚     â”‚
â”‚  â”‚  è¾“å‡ºï¼šlength_cv_per_para{}, uniformity_issues[], candidates[]     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Step 4.3: å¥å­åˆå¹¶å»ºè®® (Sentence Merger Suggestions)              â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ è¯†åˆ«è¯­ä¹‰ç›¸è¿‘çš„ç›¸é‚»å¥å­ Identify semantically related pairs   â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ ç”ŸæˆåµŒå¥—ä»å¥åˆå¹¶æ–¹æ¡ˆ Generate nested clause combinations    â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ è¯„ä¼°åˆå¹¶åçš„å¯è¯»æ€§ Evaluate readability after merge         â”‚     â”‚
â”‚  â”‚  â””â”€â”€ æä¾›åˆå¹¶é¢„è§ˆ Provide merge preview                           â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  æ£€æµ‹é¡¹ï¼šå¯åˆå¹¶çš„å¥å­å¯¹ã€åˆå¹¶æ•ˆæœè¯„ä¼°                               â”‚     â”‚
â”‚  â”‚  æ£€æµ‹å™¨ï¼šSemanticSimilarityAnalyzer + LLM Merger                   â”‚     â”‚
â”‚  â”‚  è¾“å‡ºï¼šmerge_candidates[], merge_previews[], complexity_gain       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Step 4.4: å¥é—´è¿æ¥è¯ä¼˜åŒ– (Inter-Sentence Connector Optimization)  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ£€æµ‹å¥é—´æ˜¾æ€§è¿æ¥è¯ Detect explicit sentence connectors       â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ åˆ†ç±»è¿æ¥è¯å¼ºåº¦ Classify connector strength                   â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æä¾›éšæ€§è¿æ¥æ›¿ä»£æ–¹æ¡ˆ Provide implicit alternatives           â”‚     â”‚
â”‚  â”‚  â””â”€â”€ åˆ é™¤å†—ä½™è¿æ¥è¯ Remove redundant connectors                   â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  æ£€æµ‹é¡¹ï¼šæ˜¾æ€§è¿æ¥è¯è¿‡å¤šã€è¿æ¥è¯ç±»å‹å•ä¸€                             â”‚     â”‚
â”‚  â”‚  æ£€æµ‹å™¨ï¼šConnectorAnalyzer + LLM Suggestions                       â”‚     â”‚
â”‚  â”‚  è¾“å‡ºï¼šconnector_issues[], replacement_suggestions[]               â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Step 4.5: å¥å¼å¤šæ ·åŒ–æ”¹å†™ (Pattern Diversification & Rewriting)    â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ å˜æ¢å¥å­å¼€å¤´ Transform sentence openers                      â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ è°ƒæ•´è¯­æ€ï¼ˆä¸»åŠ¨â†”è¢«åŠ¨ï¼‰Switch voice (activeâ†”passive)           â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ·»åŠ å€’è£…/å¼ºè°ƒç»“æ„ Add inversion/emphasis structures          â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€ æ‹†åˆ†è¿‡é•¿å¥å­ Split overly long sentences                     â”‚     â”‚
â”‚  â”‚  â””â”€â”€ ç»¼åˆæ”¹å†™å»ºè®® Comprehensive rewrite suggestions               â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  æ£€æµ‹é¡¹ï¼šæœ€ç»ˆå¥å¼å¤šæ ·æ€§è¯„ä¼°                                         â”‚     â”‚
â”‚  â”‚  æ£€æµ‹å™¨ï¼šLLM Diversifier + Rule Validation                         â”‚     â”‚
â”‚  â”‚  è¾“å‡ºï¼šdiversification_suggestions[], final_text                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                    â†“                                         â”‚
â”‚                     ä¼ é€’å¥å­ä¸Šä¸‹æ–‡åˆ° Layer 1 (Lexical)                       â”‚
â”‚                     Pass sentence context to Layer 1                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€å„å­æ­¥éª¤è¯¦ç»†è®¾è®¡ | Detailed Design for Each Sub-Step

### Step 4.0: å¥å­è¯†åˆ«ä¸æ ‡æ³¨ (Sentence Identification & Labeling)

**ç›®çš„ Purpose**ï¼šä½œä¸ºLayer 2çš„åŸºç¡€æ­¥éª¤ï¼Œæ¥æ”¶æ®µè½ä¸Šä¸‹æ–‡ï¼Œæ­£ç¡®åˆ†å‰²å¥å­ï¼Œå¹¶æ ‡æ³¨æ¯ä¸ªå¥å­çš„ç±»å‹å’ŒåŠŸèƒ½ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
| åŠŸèƒ½ Function | è¯´æ˜ Description |
|--------------|------------------|
| æ¥æ”¶æ®µè½ä¸Šä¸‹æ–‡ | ä»Layer 3æ¥æ”¶æ®µè½åŠå…¶å…ƒæ•°æ® |
| å¥å­åˆ†å‰² | æ­£ç¡®è¯†åˆ«å¥å­è¾¹ç•Œï¼ˆå¤„ç†ç¼©å†™ã€å¼•ç”¨ç­‰ï¼‰ |
| å¥å¼ç±»å‹æ ‡æ³¨ | Simple/Compound/Complex/Compound-Complex |
| åŠŸèƒ½è§’è‰²æ ‡æ³¨ | topic/evidence/analysis/transition/conclusion |
| ç”Ÿæˆæ˜ å°„å…³ç³» | paragraph_id â†’ sentence_ids æ˜ å°„ |

**è¾“å…¥æ•°æ®ç»“æ„**ï¼š
```python
class SentenceIdentificationRequest(BaseModel):
    document_text: str
    session_id: Optional[str]
    paragraph_context: Optional[Dict]  # From Layer 3
        # paragraphs: List[ParagraphInfo]
        # paragraph_roles: List[str]
        # paragraph_coherence: List[float]
        # locked_terms: List[str]
```

**è¾“å‡ºæ•°æ®ç»“æ„**ï¼š
```python
class SentenceIdentificationResponse(BaseModel):
    sentences: List[SentenceInfo]
    sentence_count: int
    paragraph_sentence_map: Dict[int, List[int]]  # para_idx â†’ sent_idxs
    type_distribution: Dict[str, int]  # {simple: 12, compound: 5, ...}
    risk_level: str
    recommendations: List[str]
    recommendations_zh: List[str]

class SentenceInfo(BaseModel):
    index: int
    text: str
    paragraph_index: int
    word_count: int
    sentence_type: str  # simple/compound/complex/compound_complex
    function_role: str  # topic/evidence/analysis/transition/conclusion
    has_subordinate: bool
    clause_depth: int  # ä»å¥åµŒå¥—æ·±åº¦
    voice: str  # active/passive
    opener_word: str  # å¥é¦–è¯
```

**ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4.0: å¥å­è¯†åˆ«ä¸æ ‡æ³¨ Sentence Identification & Labeling     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¯†åˆ«ç»“æœ Identification Results:                                 â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“ å¥å­æ€»æ•°: 45   |  æ®µè½æ•°: 8                                  â”‚
â”‚                                                                  â”‚
â”‚ å¥å¼ç±»å‹åˆ†å¸ƒ Sentence Type Distribution:                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Simple (ç®€å•å¥):         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  28 (62%)â”‚ â”‚
â”‚ â”‚ Compound (å¹¶åˆ—å¥):       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  8 (18%) â”‚ â”‚
â”‚ â”‚ Complex (å¤æ‚å¥):        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  6 (13%) â”‚ â”‚
â”‚ â”‚ Compound-Complex:        â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  3 (7%)  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ âš ï¸ è­¦å‘Š: ç®€å•å¥æ¯”ä¾‹ 62% è¶…è¿‡é˜ˆå€¼ 60%ï¼ŒAIç‰¹å¾æ˜æ˜¾                 â”‚
â”‚                                                                  â”‚
â”‚ æ®µè½å¥å­é¢„è§ˆ Paragraph-Sentence Preview:                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Para 1 (Introduction): 5 sentences                          â”‚ â”‚
â”‚ â”‚   S1 [Simple]  "The study examines..." (15è¯)              â”‚ â”‚
â”‚ â”‚   S2 [Simple]  "The methodology involves..." (18è¯)        â”‚ â”‚
â”‚ â”‚   S3 [Complex] "Although previous research..." (24è¯)      â”‚ â”‚
â”‚ â”‚   S4 [Simple]  "The results indicate..." (14è¯)            â”‚ â”‚
â”‚ â”‚   S5 [Simple]  "This paper contributes..." (16è¯)          â”‚ â”‚
â”‚ â”‚   âš ï¸ 4/5 ç®€å•å¥ (80%) [é«˜é£é™©]                             â”‚ â”‚
â”‚ â”‚ [å±•å¼€è¯¦æƒ…]                                                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ [ç¡®è®¤å¹¶ç»§ç»­ â†’]                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4.1: å¥å¼ç»“æ„åˆ†æ (Sentence Pattern Analysis)

**ç›®çš„ Purpose**ï¼šåœ¨æ®µè½ä¸Šä¸‹æ–‡ä¸­åˆ†æå¥å¼ç»“æ„çš„å¤šæ ·æ€§ï¼Œæ£€æµ‹AIå¼çš„å¥å¼å•ä¸€æ€§å’Œé‡å¤æ¨¡å¼ã€‚

**æ£€æµ‹é¡¹**ï¼š
| æ£€æµ‹é¡¹ Detection | è§¦å‘æ¡ä»¶ Trigger | é£é™©ç­‰çº§ Risk |
|-----------------|-----------------|---------------|
| å¥å¼ç±»å‹å•ä¸€ Type Uniformity | ç®€å•å¥æ¯”ä¾‹ > 60% | High |
| å¥é¦–è¯é‡å¤ Opener Repetition | ç›¸åŒå¼€å¤´ > 30% | High |
| ä¸»è¯­å¼€å¤´è¿‡å¤š Subject Opening | ä¸»è¯­å¼€å¤´ > 80% | Medium |
| "The"å¼€å¤´è¿‡å¤š | "The" å¼€å¤´ > 40% | High |
| è¯­æ€å•ä¸€ Voice Uniformity | ä¸»åŠ¨å¥ > 90% | Medium |
| ä»å¥æ·±åº¦ä¸è¶³ | å¹³å‡ä»å¥æ·±åº¦ < 1.2 | Medium |
| å¹³è¡Œç»“æ„è¿‡å¤š | å¹³è¡Œç»“æ„ > 30% | Medium |

**å¥é¦–è¯åˆ†ç±»**ï¼š
| ç±»å‹ Type | ç¤ºä¾‹ Examples | AIå…¸å‹ AI Pattern |
|----------|--------------|-------------------|
| å®šå† è¯ | The, This, These | è¿‡å¤š (>40%) |
| ä»£è¯ | It, They, We | å¯æ¥å— |
| å‰¯è¯å¼€å¤´ | However, Therefore, Additionally | è¿‡å¤š (>25%) |
| ä»å¥å¼€å¤´ | Although, While, When | äººç±»ç‰¹å¾ (>15%) |
| å€’è£…/å¼ºè°ƒ | Not only..., Only when..., Never... | äººç±»ç‰¹å¾ |
| åŠ¨åè¯å¼€å¤´ | Examining..., Considering... | äººç±»ç‰¹å¾ |

**è¾“å‡ºæ•°æ®ç»“æ„**ï¼š
```python
class PatternAnalysisResponse(BaseModel):
    type_distribution: Dict[str, TypeStats]
    opener_analysis: OpenerAnalysis
    voice_distribution: Dict[str, int]  # {active: 38, passive: 7}
    clause_depth_stats: ClauseDepthStats
    parallel_structure_count: int
    issues: List[PatternIssue]
    risk_level: str
    risk_score: int  # 0-100
    recommendations: List[str]
    recommendations_zh: List[str]

class TypeStats(BaseModel):
    count: int
    percentage: float
    is_risk: bool
    threshold: float

class OpenerAnalysis(BaseModel):
    opener_counts: Dict[str, int]  # {"The": 15, "This": 8, ...}
    top_repeated: List[str]        # æœ€é¢‘ç¹çš„å¼€å¤´è¯
    repetition_rate: float         # é‡å¤ç‡
    subject_opening_rate: float    # ä¸»è¯­å¼€å¤´æ¯”ä¾‹
    issues: List[str]
```

**ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4.1: å¥å¼ç»“æ„åˆ†æ Sentence Pattern Analysis                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•´ä½“å¥å¼è¯„ä¼° Overall Pattern Assessment:                         â”‚
â”‚                                                                  â”‚
â”‚ å¥å¼å¤šæ ·æ€§åˆ†æ•°: 42/100 [é«˜é£é™©] âš ï¸                               â”‚
â”‚                                                                  â”‚
â”‚ å¥å¼ç±»å‹åˆ†å¸ƒ Sentence Type Distribution:                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Type      â”‚ Count â”‚ %    â”‚ Target â”‚ Status                  â”‚ â”‚
â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚ â”‚ Simple    â”‚  28   â”‚ 62%  â”‚ 40-60% â”‚ âš ï¸ è¿‡å¤š (High Risk)     â”‚ â”‚
â”‚ â”‚ Compound  â”‚   8   â”‚ 18%  â”‚ 15-25% â”‚ âœ… æ­£å¸¸                 â”‚ â”‚
â”‚ â”‚ Complex   â”‚   6   â”‚ 13%  â”‚ 20-35% â”‚ âš ï¸ è¿‡å°‘ (Should â†‘)      â”‚ â”‚
â”‚ â”‚ Comp-Comp â”‚   3   â”‚  7%  â”‚ 10-20% â”‚ âš ï¸ è¿‡å°‘ (Should â†‘)      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ å¥é¦–è¯åˆ†æ Sentence Opener Analysis:                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å¼€å¤´è¯é‡å¤ç‡: 38% [é«˜é£é™© - è¶…è¿‡30%é˜ˆå€¼]                     â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ é«˜é¢‘å¼€å¤´è¯ Top Openers:                                     â”‚ â”‚
â”‚ â”‚ â€¢ "The" - 18æ¬¡ (40%) âš ï¸ è¿‡å¤š                               â”‚ â”‚
â”‚ â”‚ â€¢ "This" - 8æ¬¡ (18%) âš ï¸ è¿‡å¤š                               â”‚ â”‚
â”‚ â”‚ â€¢ "However" - 5æ¬¡ (11%)                                    â”‚ â”‚
â”‚ â”‚ â€¢ "Furthermore" - 4æ¬¡ (9%) âš ï¸ AIè¿æ¥è¯                     â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ä¸»è¯­å¼€å¤´æ¯”ä¾‹: 85% [é«˜é£é™© - è¶…è¿‡80%é˜ˆå€¼]                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ è¯­æ€åˆ†å¸ƒ Voice Distribution:                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Active (ä¸»åŠ¨):  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  93% âš ï¸   â”‚ â”‚
â”‚ â”‚ Passive (è¢«åŠ¨): â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7%       â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ å»ºè®®å¢åŠ è¢«åŠ¨å¥æ¯”ä¾‹è‡³ 15-30%                                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ ä»å¥åµŒå¥—æ·±åº¦ Clause Depth:                                       â”‚
â”‚ å¹³å‡æ·±åº¦: 1.1 [ä½äºç›®æ ‡ 1.5] âš ï¸                                  â”‚
â”‚ å»ºè®®: å¢åŠ å¤æ‚ä»å¥ä»¥æé«˜åµŒå¥—æ·±åº¦                                  â”‚
â”‚                                                                  â”‚
â”‚ âš ï¸ æ£€æµ‹åˆ°çš„é—®é¢˜ Detected Issues:                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. ç®€å•å¥è¿‡å¤šï¼Œç¼ºä¹å¥å¼å˜åŒ–                                  â”‚ â”‚
â”‚ â”‚ 2. "The" å¼€å¤´å¥å­è¿‡å¤šï¼Œå»ºè®®å˜æ¢å¼€å¤´æ–¹å¼                      â”‚ â”‚
â”‚ â”‚ 3. è¢«åŠ¨å¥è¿‡å°‘ï¼Œå»ºè®®é€‚å½“å¢åŠ è¢«åŠ¨è¯­æ€                          â”‚ â”‚
â”‚ â”‚ 4. ä»å¥åµŒå¥—ä¸è¶³ï¼Œå»ºè®®åˆå¹¶ç›¸å…³å¥å­                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ [AIç”Ÿæˆå¥å¼ä¼˜åŒ–å»ºè®®] [ä¸‹ä¸€æ­¥ â†’]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4.2: æ®µå†…å¥é•¿åˆ†æä¸ä¼˜åŒ– (In-Paragraph Length Analysis)

**ç›®çš„ Purpose**ï¼šåœ¨æ®µè½å°ºåº¦ä¸Šåˆ†æå¥å­é•¿åº¦åˆ†å¸ƒï¼Œæ£€æµ‹AIå¼çš„å‡åŒ€å¥é•¿ï¼Œå¹¶ç”Ÿæˆåˆå¹¶/æ‹†åˆ†å»ºè®®ã€‚

**æ ¸å¿ƒåŸåˆ™**ï¼šå¥é•¿åˆ†æå¿…é¡»åœ¨**æ®µè½ä¸Šä¸‹æ–‡**ä¸­è¿›è¡Œï¼Œå› ä¸ºï¼š
- åŒä¸€æ®µè½å†…çš„å¥å­åº”è¯¥æœ‰èŠ‚å¥å˜åŒ–
- ä¸åŒåŠŸèƒ½çš„æ®µè½ï¼ˆå¼•è¨€/æ–¹æ³•/ç»“è®ºï¼‰å¯ä»¥æœ‰ä¸åŒçš„å¥é•¿æ¨¡å¼
- AIå€¾å‘äºæ¯æ®µéƒ½ä½¿ç”¨ç›¸ä¼¼é•¿åº¦çš„å¥å­

**æ£€æµ‹é¡¹**ï¼š
| æ£€æµ‹é¡¹ Detection | é˜ˆå€¼ Threshold | AIç‰¹å¾è¯´æ˜ |
|-----------------|----------------|-----------|
| æ®µå†…å¥é•¿CV | < 0.25 | æ®µè½å†…å¥å­é•¿åº¦è¿‡äºå‡åŒ€ |
| ç¼ºå°‘çŸ­å¥ | æœ€çŸ­å¥ > 12è¯ | ç¼ºä¹å¼ºè°ƒæ€§/èŠ‚å¥æ€§çŸ­å¥ |
| ç¼ºå°‘é•¿å¥ | æœ€é•¿å¥ < 28è¯ | ç¼ºä¹å¤æ‚é•¿å¥ |
| å¥é•¿åŒºé—´è¿‡çª„ | æå·® < 15è¯ | æ‰€æœ‰å¥å­é•¿åº¦ç›¸è¿‘ |
| Burstinessä½ | < 0.3 | ç¼ºä¹é•¿çŸ­å¥äº¤æ›¿ |

**æ®µè½è§’è‰²ä¸å¥é•¿æœŸæœ›**ï¼š
| æ®µè½è§’è‰² Para Role | æœŸæœ›å¥é•¿ç‰¹å¾ Expected Pattern |
|-------------------|------------------------------|
| Introduction | ä¸­ç­‰å¥é•¿ï¼Œå¯æœ‰çŸ­å¥å¼ºè°ƒæ ¸å¿ƒè§‚ç‚¹ |
| Methodology | å¯æ¥å—å‡åŒ€å¥é•¿ï¼ˆæ­¥éª¤æè¿°ï¼‰ |
| Results | é•¿çŸ­äº¤æ›¿ï¼ˆæ•°æ®+è§£é‡Šï¼‰ |
| Discussion | å¤æ‚é•¿å¥ä¸ºä¸»ï¼ŒçŸ­å¥å¼ºè°ƒ |
| Conclusion | ä¸­çŸ­å¥ä¸ºä¸»ï¼Œç®€æ´æœ‰åŠ› |

**è¾“å‡ºæ•°æ®ç»“æ„**ï¼š
```python
class LengthAnalysisResponse(BaseModel):
    paragraph_length_stats: List[ParagraphLengthStats]
    overall_cv: float
    low_cv_paragraphs: List[int]  # CV < 0.25 çš„æ®µè½
    merge_candidates: List[MergeCandidate]
    split_candidates: List[SplitCandidate]
    issues: List[LengthIssue]
    risk_level: str
    recommendations: List[str]
    recommendations_zh: List[str]

class ParagraphLengthStats(BaseModel):
    paragraph_index: int
    paragraph_role: str
    sentence_count: int
    lengths: List[int]  # æ¯å¥è¯æ•°
    mean_length: float
    std_length: float
    cv: float  # å˜å¼‚ç³»æ•°
    min_length: int
    max_length: int
    range: int  # æå·®
    burstiness: float
    has_short_sentence: bool  # < 10è¯
    has_long_sentence: bool   # > 30è¯
    rhythm_pattern: str  # "uniform"/"variable"/"burst"
    issues: List[str]
```

**ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4.2: æ®µå†…å¥é•¿åˆ†æ In-Paragraph Length Analysis              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•´ä½“å¥é•¿è¯„ä¼° Overall Length Assessment:                          â”‚
â”‚                                                                  â”‚
â”‚ å…¨æ–‡å¥é•¿CV: 0.28 [ä¸­é£é™©]                                        â”‚
â”‚ é—®é¢˜æ®µè½æ•°: 4/8 (50%)                                            â”‚
â”‚                                                                  â”‚
â”‚ æ®µè½å¥é•¿è¯¦æƒ… Paragraph Length Details:                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Para â”‚ Role    â”‚ CV   â”‚ Range â”‚ Short â”‚ Long â”‚ Status       â”‚ â”‚
â”‚ â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚ â”‚  1   â”‚ Intro   â”‚ 0.18 â”‚ 8è¯   â”‚  âŒ   â”‚  âŒ  â”‚ âš ï¸ è¿‡äºå‡åŒ€  â”‚ â”‚
â”‚ â”‚  2   â”‚ Lit Rev â”‚ 0.22 â”‚ 12è¯  â”‚  âŒ   â”‚  âŒ  â”‚ âš ï¸ è¿‡äºå‡åŒ€  â”‚ â”‚
â”‚ â”‚  3   â”‚ Method  â”‚ 0.15 â”‚ 6è¯   â”‚  âŒ   â”‚  âŒ  â”‚ âš ï¸ è¿‡äºå‡åŒ€  â”‚ â”‚
â”‚ â”‚  4   â”‚ Results â”‚ 0.38 â”‚ 22è¯  â”‚  âœ…   â”‚  âœ…  â”‚ âœ… æ­£å¸¸      â”‚ â”‚
â”‚ â”‚  5   â”‚ Results â”‚ 0.12 â”‚ 5è¯   â”‚  âŒ   â”‚  âŒ  â”‚ âš ï¸ ä¸¥é‡å‡åŒ€  â”‚ â”‚
â”‚ â”‚  6   â”‚ Discuss â”‚ 0.42 â”‚ 25è¯  â”‚  âœ…   â”‚  âœ…  â”‚ âœ… æ­£å¸¸      â”‚ â”‚
â”‚ â”‚  7   â”‚ Discuss â”‚ 0.21 â”‚ 10è¯  â”‚  âŒ   â”‚  âŒ  â”‚ âš ï¸ è¿‡äºå‡åŒ€  â”‚ â”‚
â”‚ â”‚  8   â”‚ Conclus â”‚ 0.35 â”‚ 18è¯  â”‚  âœ…   â”‚  âŒ  â”‚ âœ… æ­£å¸¸      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ é—®é¢˜æ®µè½è¯¦æƒ… (Paragraph 1 - Introduction):                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å¥é•¿å¯è§†åŒ–:                                                 â”‚ â”‚
â”‚ â”‚ S1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  15è¯                   â”‚ â”‚
â”‚ â”‚ S2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  18è¯                   â”‚ â”‚
â”‚ â”‚ S3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  14è¯                   â”‚ â”‚
â”‚ â”‚ S4: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  17è¯                   â”‚ â”‚
â”‚ â”‚ S5: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  16è¯                   â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ CV: 0.18 | Range: 15-18è¯ (ä»…4è¯å·®) | âš ï¸ è¿‡äºå‡åŒ€          â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ä¼˜åŒ–å»ºè®®:                                                   â”‚ â”‚
â”‚ â”‚ ğŸ”— åˆå¹¶ S1+S2 â†’ åˆ›å»ºä¸€ä¸ª30+è¯çš„å¤æ‚é•¿å¥                     â”‚ â”‚
â”‚ â”‚ âœ‚ï¸ æ‹†åˆ† S3 â†’ åˆ›å»ºä¸€ä¸ª8è¯ä»¥ä¸‹çš„å¼ºè°ƒçŸ­å¥                      â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨åˆå¹¶å»ºè®®] [åº”ç”¨æ‹†åˆ†å»ºè®®] [è·³è¿‡]                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ å…¨å±€åˆå¹¶/æ‹†åˆ†å€™é€‰ Global Merge/Split Candidates:                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”— åˆå¹¶å€™é€‰ (åˆ›å»ºå¤æ‚é•¿å¥):                                  â”‚ â”‚
â”‚ â”‚    â€¢ Para 1: S1+S2 (è¯­ä¹‰ç›¸å…³åº¦: 0.85)                       â”‚ â”‚
â”‚ â”‚    â€¢ Para 2: S3+S4 (è¯­ä¹‰ç›¸å…³åº¦: 0.78)                       â”‚ â”‚
â”‚ â”‚    â€¢ Para 5: S1+S2+S3 (è¯­ä¹‰ç›¸å…³åº¦: 0.82)                    â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ âœ‚ï¸ æ‹†åˆ†å€™é€‰ (åˆ›å»ºçŸ­å¥):                                      â”‚ â”‚
â”‚ â”‚    â€¢ Para 3: S2 (28è¯ï¼Œå¯æ‹†ä¸ºå¼ºè°ƒå¥+è¡¥å……å¥)                 â”‚ â”‚
â”‚ â”‚    â€¢ Para 7: S4 (32è¯ï¼Œå¯æ‹†ä¸ºä¸»å¥+ç‹¬ç«‹çŸ­å¥)                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ [æ‰¹é‡å¤„ç†æ‰€æœ‰é—®é¢˜æ®µè½] [é€ä¸ªå¤„ç†] [ä¸‹ä¸€æ­¥ â†’]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4.3: å¥å­åˆå¹¶å»ºè®® (Sentence Merger Suggestions)

**ç›®çš„ Purpose**ï¼šè¯†åˆ«è¯­ä¹‰ç›¸è¿‘çš„ç›¸é‚»å¥å­ï¼Œç”Ÿæˆå¤æ‚é•¿å¥ï¼ˆåµŒå¥—ä»å¥ï¼‰ï¼Œå¢åŠ å¥å¼å¤æ‚åº¦å’Œé•¿åº¦å˜å¼‚ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
| åŠŸèƒ½ Function | è¯´æ˜ Description |
|--------------|------------------|
| è¯­ä¹‰ç›¸ä¼¼åº¦è®¡ç®— | è®¡ç®—ç›¸é‚»å¥å­çš„è¯­ä¹‰ç›¸å…³åº¦ |
| å…³ç³»ç±»å‹è¯†åˆ« | è¯†åˆ«å¥å­é—´é€»è¾‘å…³ç³»ï¼ˆå› æœ/å¯¹æ¯”/è¡¥å……/æ—¶åºï¼‰ |
| ä»å¥ç”Ÿæˆ | ç”ŸæˆåµŒå¥—ä»å¥ç»“æ„çš„åˆå¹¶æ–¹æ¡ˆ |
| å¯è¯»æ€§è¯„ä¼° | ç¡®ä¿åˆå¹¶åå¥å­ä»ç„¶å¯è¯» |

**åˆå¹¶ç±»å‹**ï¼š
| åˆå¹¶ç±»å‹ Merge Type | ä½¿ç”¨ä»å¥ Subordinate | ç¤ºä¾‹ Example |
|--------------------|---------------------|--------------|
| å› æœå…³ç³» Causal | because, since, as | "A happens. B results." â†’ "Since A happens, B results." |
| å¯¹æ¯”å…³ç³» Contrast | although, while, whereas | "A is true. B is different." â†’ "Although A is true, B is different." |
| æ—¶åºå…³ç³» Temporal | when, after, before | "A occurred. Then B." â†’ "After A occurred, B happened." |
| è¡¥å……å…³ç³» Addition | which, that, where | "A exists. A has property." â†’ "A, which has property, exists." |
| æ¡ä»¶å…³ç³» Conditional | if, provided, unless | "A is needed. B follows." â†’ "If A is provided, B follows." |

**è¯­ä¹‰ç›¸ä¼¼åº¦é˜ˆå€¼**ï¼š
| ç›¸ä¼¼åº¦ Similarity | å»ºè®® Recommendation |
|------------------|---------------------|
| > 0.85 | å¼ºçƒˆå»ºè®®åˆå¹¶ |
| 0.70-0.85 | å»ºè®®åˆå¹¶ |
| 0.50-0.70 | å¯é€‰åˆå¹¶ |
| < 0.50 | ä¸å»ºè®®åˆå¹¶ |

**è¾“å‡ºæ•°æ®ç»“æ„**ï¼š
```python
class MergerSuggestionsResponse(BaseModel):
    merge_candidates: List[MergeCandidate]
    applied_merges: List[AppliedMerge]
    complexity_improvement: float  # å¤æ‚åº¦æå‡ç™¾åˆ†æ¯”
    new_sentence_types: Dict[str, int]  # åˆå¹¶åçš„å¥å¼åˆ†å¸ƒ
    issues: List[str]
    recommendations: List[str]
    recommendations_zh: List[str]

class MergeCandidate(BaseModel):
    paragraph_index: int
    sentence_indices: List[int]  # è¦åˆå¹¶çš„å¥å­ç´¢å¼•
    original_sentences: List[str]
    semantic_similarity: float
    relation_type: str  # causal/contrast/temporal/addition/conditional
    merged_sentence: str  # LLMç”Ÿæˆçš„åˆå¹¶ç»“æœ
    subordinate_type: str  # ä½¿ç”¨çš„ä»å¥ç±»å‹
    new_word_count: int
    readability_score: float  # å¯è¯»æ€§è¯„åˆ† 0-1
    confidence: float
```

**ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4.3: å¥å­åˆå¹¶å»ºè®® Sentence Merger Suggestions               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åˆå¹¶æ¦‚è§ˆ Merge Overview:                                         â”‚
â”‚                                                                  â”‚
â”‚ è¯†åˆ«åˆ°çš„åˆå¹¶å€™é€‰: 8ç»„                                            â”‚
â”‚ é¢„è®¡å¤æ‚åº¦æå‡: +35%                                             â”‚
â”‚ é¢„è®¡å¥å¼å¤šæ ·æ€§æå‡: +28%                                          â”‚
â”‚                                                                  â”‚
â”‚ åˆå¹¶å€™é€‰åˆ—è¡¨ Merge Candidates:                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å€™é€‰ 1 (Para 1, S1+S2) | ç›¸ä¼¼åº¦: 0.88 | å…³ç³»: Causal        â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åŸå¥ Original:                                              â”‚ â”‚
â”‚ â”‚ S1: "The study examines the relationship between A and B."  â”‚ â”‚
â”‚ â”‚ S2: "This examination reveals significant patterns."        â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åˆå¹¶æ–¹æ¡ˆ Merged:                                            â”‚ â”‚
â”‚ â”‚ "The study examines the relationship between A and B,       â”‚ â”‚
â”‚ â”‚ which reveals significant patterns in the data."            â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ğŸ“Š æ”¹è¿›æ•ˆæœ:                                                â”‚ â”‚
â”‚ â”‚ â€¢ è¯æ•°: 15+10 â†’ 22è¯ (å¢åŠ å¤æ‚åº¦)                          â”‚ â”‚
â”‚ â”‚ â€¢ å¥å¼: Simple+Simple â†’ Complex (å…³ç³»ä»å¥)                 â”‚ â”‚
â”‚ â”‚ â€¢ å¯è¯»æ€§: 0.85/1.0 âœ…                                      â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨æ­¤åˆå¹¶] [ä¿®æ”¹ååº”ç”¨] [è·³è¿‡]                            â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ å€™é€‰ 2 (Para 2, S3+S4) | ç›¸ä¼¼åº¦: 0.82 | å…³ç³»: Contrast      â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åŸå¥ Original:                                              â”‚ â”‚
â”‚ â”‚ S3: "Previous research focused primarily on method X."      â”‚ â”‚
â”‚ â”‚ S4: "However, method Y shows greater potential."            â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åˆå¹¶æ–¹æ¡ˆ Merged:                                            â”‚ â”‚
â”‚ â”‚ "Although previous research focused primarily on method X,  â”‚ â”‚
â”‚ â”‚ method Y shows greater potential for addressing this issue."â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ğŸ“Š æ”¹è¿›æ•ˆæœ:                                                â”‚ â”‚
â”‚ â”‚ â€¢ è¯æ•°: 12+14 â†’ 24è¯                                       â”‚ â”‚
â”‚ â”‚ â€¢ å¥å¼: Simple+Simple â†’ Complex (è®©æ­¥ä»å¥)                 â”‚ â”‚
â”‚ â”‚ â€¢ é¢å¤–: ç§»é™¤æ˜¾æ€§è¿æ¥è¯ "However"                           â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨æ­¤åˆå¹¶] [ä¿®æ”¹ååº”ç”¨] [è·³è¿‡]                            â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ å€™é€‰ 3 (Para 5, S1+S2+S3) | ä¸‰å¥åˆå¹¶ | å…³ç³»: Temporal       â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åŸå¥ Original:                                              â”‚ â”‚
â”‚ â”‚ S1: "The data was collected over six months."               â”‚ â”‚
â”‚ â”‚ S2: "The analysis was then performed."                      â”‚ â”‚
â”‚ â”‚ S3: "The results were subsequently validated."              â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åˆå¹¶æ–¹æ¡ˆ Merged:                                            â”‚ â”‚
â”‚ â”‚ "After collecting data over six months, we performed the    â”‚ â”‚
â”‚ â”‚ analysis, whose results were subsequently validated         â”‚ â”‚
â”‚ â”‚ through multiple methods."                                   â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ğŸ“Š æ”¹è¿›æ•ˆæœ:                                                â”‚ â”‚
â”‚ â”‚ â€¢ è¯æ•°: 8+6+6 â†’ 28è¯ (å¤åˆå¤æ‚å¥)                          â”‚ â”‚
â”‚ â”‚ â€¢ å¥å¼: 3Ã—Simple â†’ Compound-Complex                        â”‚ â”‚
â”‚ â”‚ â€¢ å¯è¯»æ€§: 0.78/1.0 âœ…                                      â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨æ­¤åˆå¹¶] [ä¿®æ”¹ååº”ç”¨] [è·³è¿‡]                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ [æ‰¹é‡åº”ç”¨æ‰€æœ‰é«˜ç½®ä¿¡åº¦åˆå¹¶] [é€ä¸ªå¤„ç†] [ä¸‹ä¸€æ­¥ â†’]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4.4: å¥é—´è¿æ¥è¯ä¼˜åŒ– (Inter-Sentence Connector Optimization)

**ç›®çš„ Purpose**ï¼šæ£€æµ‹å’Œä¼˜åŒ–å¥å­ä¹‹é—´çš„æ˜¾æ€§è¿æ¥è¯ï¼Œæä¾›éšæ€§è¿æ¥æ›¿ä»£æ–¹æ¡ˆã€‚

**AIè¿æ¥è¯ç‰¹å¾**ï¼š
| ç±»å‹ Type | AIé«˜é¢‘è¯ AI Common | é£é™©ç­‰çº§ |
|-----------|-------------------|---------|
| é€’è¿›ç±» Addition | Furthermore, Moreover, Additionally, In addition | High |
| å› æœç±» Causal | Therefore, Thus, Hence, Consequently, As a result | Medium |
| å¯¹æ¯”ç±» Contrast | However, Nevertheless, On the other hand | Medium |
| é¡ºåºç±» Sequence | First, Second, Third, Finally, Lastly | High |
| æ€»ç»“ç±» Summary | In conclusion, To summarize, Overall, In summary | High |

**æ›¿ä»£ç­–ç•¥**ï¼š
| ç­–ç•¥ Strategy | è¯´æ˜ Description | ç¤ºä¾‹ Example |
|--------------|-----------------|--------------|
| è¯­ä¹‰å›å£° Semantic Echo | ç”¨ä¸Šå¥å…³é”®è¯å¼€å¤´ | "This pattern..." (å›å£°ä¸Šå¥çš„pattern) |
| åˆ é™¤è¿æ¥è¯ Remove | ç›´æ¥åˆ é™¤ï¼Œä¾é å†…å®¹é€»è¾‘ | åˆ é™¤ "Furthermore," |
| ä»å¥æ›¿æ¢ Subordinate | ç”¨ä»å¥å»ºç«‹å…³ç³» | "However, A" â†’ "While B, A" |
| ä»£è¯å›æŒ‡ Pronoun | ç”¨ä»£è¯å»ºç«‹å…³è” | "This finding..." |
| è¯æ±‡é‡å¤ Lexical Link | é‡å¤å…³é”®æ¦‚å¿µè¯ | ä¸Šå¥"method" â†’ ä¸‹å¥"method" |

**è¾“å‡ºæ•°æ®ç»“æ„**ï¼š
```python
class ConnectorOptimizationResponse(BaseModel):
    connector_issues: List[ConnectorIssue]
    total_connectors: int
    explicit_ratio: float  # æ˜¾æ€§è¿æ¥è¯æ¯”ä¾‹
    connector_type_distribution: Dict[str, int]
    replacement_suggestions: List[ReplacementSuggestion]
    risk_level: str
    recommendations: List[str]
    recommendations_zh: List[str]

class ConnectorIssue(BaseModel):
    paragraph_index: int
    sentence_index: int
    connector: str
    connector_type: str  # addition/causal/contrast/sequence/summary
    position: str  # "start"/"middle"
    risk_level: str
    context: str  # å‰åå¥å­

class ReplacementSuggestion(BaseModel):
    original_connector: str
    replacement_type: str  # semantic_echo/remove/subordinate/pronoun/lexical
    new_text: str
    explanation: str
    explanation_zh: str
```

**ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4.4: å¥é—´è¿æ¥è¯ä¼˜åŒ– Inter-Sentence Connector Optimization   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¿æ¥è¯æ¦‚è§ˆ Connector Overview:                                   â”‚
â”‚                                                                  â”‚
â”‚ æ˜¾æ€§è¿æ¥è¯æ¯”ä¾‹: 42% [é«˜é£é™© - è¶…è¿‡25%é˜ˆå€¼]                       â”‚
â”‚ è¿æ¥è¯æ€»æ•°: 19ä¸ª                                                 â”‚
â”‚                                                                  â”‚
â”‚ è¿æ¥è¯ç±»å‹åˆ†å¸ƒ Connector Type Distribution:                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Addition (é€’è¿›):  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  9ä¸ª (47%) âš ï¸     â”‚ â”‚
â”‚ â”‚ Causal (å› æœ):    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  4ä¸ª (21%)        â”‚ â”‚
â”‚ â”‚ Contrast (å¯¹æ¯”):  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  3ä¸ª (16%)        â”‚ â”‚
â”‚ â”‚ Sequence (é¡ºåº):  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  2ä¸ª (11%) âš ï¸     â”‚ â”‚
â”‚ â”‚ Summary (æ€»ç»“):   â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  1ä¸ª (5%)         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ âš ï¸ é«˜é£é™©è¿æ¥è¯ High-Risk Connectors:                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. "Furthermore" at Para 1, S3                              â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ä¸Šä¸‹æ–‡ Context:                                             â”‚ â”‚
â”‚ â”‚ S2: "...the methodology provides accurate results."         â”‚ â”‚
â”‚ â”‚ S3: "Furthermore, the cost efficiency is notable."          â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ æ›¿æ¢å»ºè®® Replacement Options:                               â”‚ â”‚
â”‚ â”‚ â—‹ è¯­ä¹‰å›å£°: "The accuracy extends to cost efficiency..."    â”‚ â”‚
â”‚ â”‚ â—‹ åˆ é™¤: "The cost efficiency is also notable."              â”‚ â”‚
â”‚ â”‚ â—‹ ä»å¥: "Besides being accurate, the method is efficient."  â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨ è¯­ä¹‰å›å£°] [åº”ç”¨ åˆ é™¤] [åº”ç”¨ ä»å¥] [è·³è¿‡]              â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 2. "Moreover" at Para 2, S4                                 â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ä¸Šä¸‹æ–‡ Context:                                             â”‚ â”‚
â”‚ â”‚ S3: "...previous studies show limitation X."                â”‚ â”‚
â”‚ â”‚ S4: "Moreover, limitation Y remains unaddressed."           â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ æ›¿æ¢å»ºè®® Replacement Options:                               â”‚ â”‚
â”‚ â”‚ â—‹ è¯­ä¹‰å›å£°: "These limitations extend to Y..."              â”‚ â”‚
â”‚ â”‚ â—‹ åˆå¹¶ä»å¥: "In addition to X, Y remains unaddressed."      â”‚ â”‚
â”‚ â”‚ â—‹ è¯æ±‡è¿æ¥: "A related limitation is Y..."                  â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨ è¯­ä¹‰å›å£°] [åº”ç”¨ åˆå¹¶] [åº”ç”¨ è¯æ±‡] [è·³è¿‡]              â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 3. "Therefore" at Para 4, S2                                â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ä¸Šä¸‹æ–‡ Context:                                             â”‚ â”‚
â”‚ â”‚ S1: "The results show a significant correlation (r=0.85)."  â”‚ â”‚
â”‚ â”‚ S2: "Therefore, hypothesis H1 is supported."                â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ æ›¿æ¢å»ºè®® Replacement Options:                               â”‚ â”‚
â”‚ â”‚ â—‹ è¯­ä¹‰å›å£°: "This strong correlation supports H1."          â”‚ â”‚
â”‚ â”‚ â—‹ åˆ é™¤: "Hypothesis H1 is thus supported."                  â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [åº”ç”¨ è¯­ä¹‰å›å£°] [åº”ç”¨ åˆ é™¤] [è·³è¿‡]                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ [æ‰¹é‡å¤„ç†æ‰€æœ‰é«˜é£é™©è¿æ¥è¯] [é€ä¸ªå¤„ç†] [ä¸‹ä¸€æ­¥ â†’]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4.5: å¥å¼å¤šæ ·åŒ–æ”¹å†™ (Pattern Diversification & Rewriting)

**ç›®çš„ Purpose**ï¼šé€šè¿‡LLMé©±åŠ¨çš„æ”¹å†™ï¼Œç»¼åˆæå‡å¥å¼å¤šæ ·æ€§ï¼ŒåŒ…æ‹¬å¼€å¤´å˜æ¢ã€è¯­æ€è°ƒæ•´ã€å€’è£…æ·»åŠ ç­‰ã€‚

**å¤šæ ·åŒ–ç­–ç•¥**ï¼š
| ç­–ç•¥ Strategy | è¯´æ˜ Description | ç¤ºä¾‹ Example |
|--------------|-----------------|--------------|
| å¼€å¤´å˜æ¢ Opener Change | æ”¹å˜å¥å­å¼€å¤´æ–¹å¼ | "The study shows..." â†’ "Examining this, we find..." |
| è¯­æ€åˆ‡æ¢ Voice Switch | ä¸»åŠ¨â†”è¢«åŠ¨åˆ‡æ¢ | "We analyzed..." â†’ "The data was analyzed..." |
| å€’è£…æ·»åŠ  Inversion | æ·»åŠ å€’è£…ç»“æ„ | "The results are clear." â†’ "Clear are the results." |
| å¼ºè°ƒç»“æ„ Emphasis | ä½¿ç”¨å¼ºè°ƒå¥å¼ | "We found X." â†’ "It was X that we found." |
| åˆ†è¯å¼€å¤´ Participle | ä½¿ç”¨åˆ†è¯çŸ­è¯­å¼€å¤´ | "We examined X." â†’ "Examining X, we found..." |
| ä»‹è¯çŸ­è¯­å¼€å¤´ Prepositional | ä»¥ä»‹è¯çŸ­è¯­å¼€å¤´ | "The study..." â†’ "In this study, we..." |
| å‰¯è¯å¼€å¤´ Adverb | ä»¥å‰¯è¯å¼€å¤´ï¼ˆéè¿æ¥è¯ï¼‰ | "The method works." â†’ "Effectively, the method works." |

**æ‹†åˆ†ç­–ç•¥**ï¼š
| æ‹†åˆ†ç±»å‹ Split Type | è¯´æ˜ Description | ç¤ºä¾‹ Example |
|--------------------|-----------------|--------------|
| å¼ºè°ƒæ‹†åˆ† Emphasis Split | åˆ›å»ºå¼ºè°ƒæ€§çŸ­å¥ | "A, which is important, shows B." â†’ "A is important. It shows B." |
| è¡¥å……æ‹†åˆ† Supplement Split | ç‹¬ç«‹è¡¥å……ä¿¡æ¯ | "A with property B..." â†’ "A exists. Notably, it has B." |
| å¯¹æ¯”æ‹†åˆ† Contrast Split | ç‹¬ç«‹å¯¹æ¯”ç‚¹ | "A but B" â†’ "A holds true. B, however, differs." |

**è¾“å‡ºæ•°æ®ç»“æ„**ï¼š
```python
class DiversificationResponse(BaseModel):
    diversified_paragraphs: List[DiversifiedParagraph]
    applied_strategies: Dict[str, int]  # ä½¿ç”¨çš„ç­–ç•¥ç»Ÿè®¡
    before_metrics: PatternMetrics
    after_metrics: PatternMetrics
    improvement_summary: ImprovementSummary
    final_text: str
    recommendations: List[str]
    recommendations_zh: List[str]

class DiversifiedParagraph(BaseModel):
    paragraph_index: int
    original_text: str
    diversified_text: str
    changes: List[ChangeRecord]

class ChangeRecord(BaseModel):
    sentence_index: int
    original: str
    new: str
    strategy: str
    improvement_type: str  # opener/voice/structure/length

class PatternMetrics(BaseModel):
    simple_ratio: float
    compound_ratio: float
    complex_ratio: float
    compound_complex_ratio: float
    opener_diversity: float  # å¼€å¤´å¤šæ ·æ€§ 0-1
    voice_balance: float  # è¯­æ€å¹³è¡¡ 0-1
    length_cv: float
    overall_score: float  # 0-100

class ImprovementSummary(BaseModel):
    pattern_score_change: float  # +/-
    opener_diversity_change: float
    voice_balance_change: float
    length_cv_change: float
    risk_level_before: str
    risk_level_after: str
```

**ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4.5: å¥å¼å¤šæ ·åŒ–æ”¹å†™ Pattern Diversification & Rewriting     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ”¹å†™æ¦‚è§ˆ Diversification Overview:                               â”‚
â”‚                                                                  â”‚
â”‚ æ”¹è¿›æ•ˆæœ Improvement Summary:                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æŒ‡æ ‡              â”‚ æ”¹å‰    â”‚ æ”¹å    â”‚ å˜åŒ–              â”‚ â”‚
â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚ â”‚ å¥å¼å¤šæ ·æ€§åˆ†æ•°    â”‚ 42      â”‚ 68      â”‚ +26 âœ…            â”‚ â”‚
â”‚ â”‚ ç®€å•å¥æ¯”ä¾‹        â”‚ 62%     â”‚ 48%     â”‚ -14% âœ…           â”‚ â”‚
â”‚ â”‚ å¤æ‚å¥æ¯”ä¾‹        â”‚ 13%     â”‚ 28%     â”‚ +15% âœ…           â”‚ â”‚
â”‚ â”‚ å¼€å¤´å¤šæ ·æ€§        â”‚ 0.35    â”‚ 0.72    â”‚ +0.37 âœ…          â”‚ â”‚
â”‚ â”‚ è¯­æ€å¹³è¡¡          â”‚ 0.12    â”‚ 0.25    â”‚ +0.13 âœ…          â”‚ â”‚
â”‚ â”‚ å¥é•¿CV            â”‚ 0.22    â”‚ 0.38    â”‚ +0.16 âœ…          â”‚ â”‚
â”‚ â”‚ é£é™©ç­‰çº§          â”‚ High    â”‚ Low     â”‚ â¬‡ï¸ é™ä½           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ åº”ç”¨çš„ç­–ç•¥ç»Ÿè®¡ Applied Strategies:                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â€¢ å¼€å¤´å˜æ¢ (Opener Change): 8æ¬¡                             â”‚ â”‚
â”‚ â”‚ â€¢ è¯­æ€åˆ‡æ¢ (Voice Switch): 5æ¬¡                              â”‚ â”‚
â”‚ â”‚ â€¢ å¥å­åˆå¹¶ (Sentence Merge): 4æ¬¡                            â”‚ â”‚
â”‚ â”‚ â€¢ å¥å­æ‹†åˆ† (Sentence Split): 3æ¬¡                            â”‚ â”‚
â”‚ â”‚ â€¢ è¿æ¥è¯ä¼˜åŒ– (Connector Fix): 6æ¬¡                           â”‚ â”‚
â”‚ â”‚ â€¢ å€’è£…æ·»åŠ  (Inversion): 2æ¬¡                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ æ”¹å†™é¢„è§ˆ Rewriting Preview:                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Paragraph 1 (Introduction):                                 â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ åŸæ–‡ Original:                                              â”‚ â”‚
â”‚ â”‚ "The study examines the relationship between A and B.       â”‚ â”‚
â”‚ â”‚ The methodology involves analysis of 500 samples.           â”‚ â”‚
â”‚ â”‚ The results indicate significant patterns.                  â”‚ â”‚
â”‚ â”‚ Furthermore, the implications are discussed."               â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ æ”¹å Diversified:                                           â”‚ â”‚
â”‚ â”‚ "Examining the relationship between A and B, this study     â”‚ â”‚
â”‚ â”‚ analyzes 500 samples through a novel methodology.           â”‚ â”‚
â”‚ â”‚ Significant patterns emerge from the results, whose         â”‚ â”‚
â”‚ â”‚ implications extend to practical applications."             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ğŸ“Š æ”¹è¿›è¯¦æƒ…:                                                â”‚ â”‚
â”‚ â”‚ â€¢ S1: å¼€å¤´å˜æ¢ (The study â†’ Examining...)                  â”‚ â”‚
â”‚ â”‚ â€¢ S1+S2: åˆå¹¶ä¸ºå¤æ‚å¥                                      â”‚ â”‚
â”‚ â”‚ â€¢ S3: è¯­æ€å˜æ¢ + å¼€å¤´å˜æ¢                                  â”‚ â”‚
â”‚ â”‚ â€¢ S4: ç§»é™¤ "Furthermore" + ä»å¥åˆå¹¶                        â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [æ¥å—æ­¤æ®µè½æ”¹å†™] [ä¿®æ”¹] [æ¢å¤åŸæ–‡]                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚ å…¶ä»–æ®µè½æ”¹å†™... (æŠ˜å )                                           â”‚
â”‚                                                                  â”‚
â”‚ [æ¥å—æ‰€æœ‰æ”¹å†™å¹¶ç»§ç»­] [é€æ®µå®¡æ ¸] [è¿›å…¥Layer 1 â†’]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äº”ã€APIç«¯ç‚¹è®¾è®¡ | API Endpoint Design

### 5.1 ç«¯ç‚¹åˆ—è¡¨ | Endpoint List

```python
# Layer 2 Sentence-level Endpoints
# Base URL: /api/v1/analysis/sentence/

# Step 4.0: Sentence Identification
POST /step4-0/identify          # å¥å­è¯†åˆ«ä¸æ ‡æ³¨
GET  /step4-0/result/{session}  # è·å–è¯†åˆ«ç»“æœ

# Step 4.1: Pattern Analysis
POST /step4-1/analyze           # å¥å¼ç»“æ„åˆ†æ
POST /step4-1/ai-suggest        # AIç”Ÿæˆå¥å¼ä¼˜åŒ–å»ºè®®

# Step 4.2: Length Analysis
POST /step4-2/analyze           # æ®µå†…å¥é•¿åˆ†æ
POST /step4-2/suggest           # ç”Ÿæˆåˆå¹¶/æ‹†åˆ†å»ºè®®
POST /step4-2/apply             # åº”ç”¨é•¿åº¦è°ƒæ•´

# Step 4.3: Sentence Merger
POST /step4-3/analyze           # åˆ†æå¯åˆå¹¶å¥å­
POST /step4-3/preview           # é¢„è§ˆåˆå¹¶æ•ˆæœ
POST /step4-3/apply             # åº”ç”¨å¥å­åˆå¹¶

# Step 4.4: Connector Optimization
POST /step4-4/analyze           # è¿æ¥è¯åˆ†æ
POST /step4-4/suggest           # ç”Ÿæˆæ›¿æ¢å»ºè®®
POST /step4-4/apply             # åº”ç”¨è¿æ¥è¯ä¼˜åŒ–

# Step 4.5: Diversification
POST /step4-5/analyze           # ç»¼åˆå¤šæ ·åŒ–åˆ†æ
POST /step4-5/preview           # é¢„è§ˆæ”¹å†™æ•ˆæœ
POST /step4-5/apply             # åº”ç”¨å¤šæ ·åŒ–æ”¹å†™

# Combined Analysis
POST /analyze                   # å®Œæ•´å¥å­å±‚åˆ†æ
GET  /context                   # è·å–å¥å­ä¸Šä¸‹æ–‡(ä¼ é€’ç»™Layer 1)
```

### 5.2 è¯·æ±‚/å“åº”Schemaè®¾è®¡ | Request/Response Schemas

```python
# Common Request Base
class Layer2BaseRequest(BaseModel):
    text: Optional[str]                       # åŸæ–‡
    paragraphs: Optional[List[str]]           # æ®µè½åˆ—è¡¨
    session_id: Optional[str]                 # ä¼šè¯ID
    paragraph_context: Optional[Dict]         # Layer 3ä¼ å…¥çš„æ®µè½ä¸Šä¸‹æ–‡
    locked_terms: Optional[List[str]]         # é”å®šè¯æ±‡ï¼ˆä»Layer 5ä¼ é€’ï¼‰

# Common Response Base
class Layer2BaseResponse(BaseModel):
    risk_score: int                           # 0-100
    risk_level: str                           # low/medium/high
    issues: List[DetectionIssue]
    recommendations: List[str]
    recommendations_zh: List[str]
    processing_time_ms: int
```

---

## å…­ã€æ£€æµ‹å™¨é›†æˆæ–¹æ¡ˆ | Detector Integration Plan

### 6.1 é›†æˆæ˜ å°„ | Integration Mapping

| å­æ­¥éª¤ Sub-Step | æ£€æµ‹å™¨ Detectors | ç±»å‹ Type |
|----------------|-----------------|-----------|
| Step 4.0 | SentenceSegmenter + SyntaxParser | Rule + NLP |
| Step 4.1 | SyntaxPatternAnalyzer | Rule-based + NLP |
| Step 4.2 | SentenceLengthAnalyzer | Statistical |
| Step 4.3 | SemanticSimilarityAnalyzer + LLM | NLP + LLM |
| Step 4.4 | ConnectorAnalyzer + LLM | Rule + LLM |
| Step 4.5 | LLM Diversifier + Rule Validator | LLM + Rule |

### 6.2 æ•°æ®æµè®¾è®¡ | Data Flow Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ•°æ®æµ Data Flow                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ä» Layer 3 æ¥æ”¶ From Layer 3:                                    â”‚
â”‚  {                                                                â”‚
â”‚    "paragraphs": [...],                                           â”‚
â”‚    "paragraph_roles": [...],                                      â”‚
â”‚    "paragraph_coherence": [...],                                  â”‚
â”‚    "sentence_length_cvs": [...],                                  â”‚
â”‚    "anchor_densities": [...],                                     â”‚
â”‚    "locked_terms": [...]                                          â”‚
â”‚  }                                                                â”‚
â”‚       â†“                                                           â”‚
â”‚  Step 4.0 â†’ sentences[] + sentence_types[] â†’ Sessionå­˜å‚¨         â”‚
â”‚       â†“                                                           â”‚
â”‚  Step 4.1 (åŸºäºsentences) â†’ pattern_issues[] â†’ Sessionå­˜å‚¨       â”‚
â”‚       â†“                                                           â”‚
â”‚  Step 4.2 (åŸºäºsentences, per paragraph) â†’ length_issues[]       â”‚
â”‚       â†“                                                           â”‚
â”‚  Step 4.3 (åŸºäºStep 4.2å»ºè®®) â†’ merged_sentences[]                â”‚
â”‚       â†“                                                           â”‚
â”‚  Step 4.4 (åŸºäºä¿®æ”¹åæ–‡æœ¬) â†’ connector_replacements[]             â”‚
â”‚       â†“                                                           â”‚
â”‚  Step 4.5 (ç»¼åˆä¼˜åŒ–) â†’ diversified_text[]                        â”‚
â”‚       â†“                                                           â”‚
â”‚  ä¼ é€’ç»™ Layer 1 Pass to Layer 1:                                  â”‚
â”‚  {                                                                â”‚
â”‚    "paragraphs": [...],                                           â”‚
â”‚    "sentences": [...],                                            â”‚
â”‚    "sentence_patterns": [...],                                    â”‚
â”‚    "sentence_lengths": [...],                                     â”‚
â”‚    "connector_positions": [...],                                  â”‚
â”‚    "locked_terms": [...]                                          â”‚
â”‚  }                                                                â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸ƒã€ä¸Layer 5/Layer 4/Layer 3çš„å¯¹æ¯” | Comparison with Layer 5/4/3

### 7.1 è®¾è®¡æ¨¡å¼å¯¹æ¯” | Design Pattern Comparison

| å±‚çº§ Layer | åŸºç¡€æ­¥éª¤ (X.0) | ä¸»è¦æ­¥éª¤ | æ ¸å¿ƒå…³æ³¨ç‚¹ Focus |
|-----------|---------------|---------|-----------------|
| **Layer 5** | 1.0 è¯æ±‡é”å®š | 1.1-1.5 | å…¨æ–‡ç»“æ„ã€ç« èŠ‚é¡ºåºã€æ®µè½é•¿åº¦ã€è¿æ¥è¯ |
| **Layer 4** | 2.0 ç« èŠ‚è¯†åˆ« | 2.1-2.5 | ç« èŠ‚é¡ºåºã€é•¿åº¦åˆ†å¸ƒã€ç›¸ä¼¼æ€§ã€è¿‡æ¸¡ã€é€»è¾‘ |
| **Layer 3** | 3.0 æ®µè½è¯†åˆ« | 3.1-3.5 | æ®µè½è§’è‰²ã€è¿è´¯æ€§ã€é”šç‚¹ã€å¥é•¿ã€è¿‡æ¸¡ |
| **Layer 2** | 4.0 å¥å­è¯†åˆ« | 4.1-4.5 | å¥å¼ç»“æ„ã€å¥é•¿åˆ†å¸ƒã€åˆå¹¶æ‹†åˆ†ã€è¿æ¥è¯ã€å¤šæ ·åŒ– |

### 7.2 æ­¥éª¤æ•°é‡å¯¹æ¯” | Step Count Comparison

| Layer | æ­¥éª¤æ•° | æ­¥éª¤ç¼–å· |
|-------|-------|---------|
| Layer 5 | 6 | 1.0, 1.1, 1.2, 1.3, 1.4, 1.5 |
| Layer 4 | 6 | 2.0, 2.1, 2.2, 2.3, 2.4, 2.5 |
| Layer 3 | 6 | 3.0, 3.1, 3.2, 3.3, 3.4, 3.5 |
| Layer 2 | 6 | 4.0, 4.1, 4.2, 4.3, 4.4, 4.5 |

### 7.3 Layer 2 æ ¸å¿ƒå·®å¼‚ | Layer 2 Key Differences

| ç‰¹ç‚¹ Feature | Layer 3 (æ®µè½) | Layer 2 (å¥å­) |
|-------------|---------------|---------------|
| **åˆ†æå•å…ƒ** | æ®µè½ä½œä¸ºæ•´ä½“ | æ®µè½å†…çš„æ¯ä¸ªå¥å­ |
| **ä¸Šä¸‹æ–‡** | ç« èŠ‚ä¸Šä¸‹æ–‡ | æ®µè½ä¸Šä¸‹æ–‡ |
| **æ“ä½œç±»å‹** | æ£€æµ‹+å»ºè®® | æ£€æµ‹+åˆå¹¶/æ‹†åˆ†/æ”¹å†™ |
| **LLMä½¿ç”¨** | åˆ†æ+å»ºè®® | åˆ†æ+æ”¹å†™+ç”Ÿæˆ |
| **ç”¨æˆ·äº¤äº’** | ç¡®è®¤é—®é¢˜ | ç¡®è®¤æ”¹å†™ç»“æœ |

---

## å…«ã€é•¿æ–‡æ¡£å¤„ç†ç­–ç•¥ | Long Document Processing Strategy

### 8.1 å¤„ç†ç­–ç•¥å¯¹æ¯” | Processing Strategy Comparison

| ç­–ç•¥ Strategy | ä¼˜ç‚¹ Pros | ç¼ºç‚¹ Cons | é€‚ç”¨åœºæ™¯ |
|--------------|----------|----------|---------|
| **å…¨æ–‡ä¸€æ¬¡æ€§å¤„ç†** | å…¨å±€ç»Ÿè®¡å‡†ç¡® | å†…å­˜å ç”¨å¤§ï¼Œç”¨æˆ·ç­‰å¾…é•¿ | çŸ­æ–‡æ¡£ (<3000è¯) |
| **æŒ‰ç« èŠ‚å¤„ç†** | ä¸Šä¸‹æ–‡è¾ƒå®Œæ•´ | å•ç« èŠ‚å¯èƒ½ä»ç„¶å¾ˆé•¿ | ä¸­ç­‰æ–‡æ¡£ |
| **æŒ‰æ®µè½è¿­ä»£å¤„ç†** âœ… | ç²’åº¦åˆé€‚ï¼Œæ”¯æŒä¸ªæ€§åŒ– | éœ€è¦æ±‡æ€»å…¨å±€ç»Ÿè®¡ | ä»»æ„é•¿åº¦æ–‡æ¡£ |

### 8.2 æ¨èç­–ç•¥ï¼šæŒ‰æ®µè½è¿­ä»£å¤„ç† | Recommended: Paragraph-by-Paragraph Iteration

**æ ¸å¿ƒåŸåˆ™**ï¼šå¥å­æ“ä½œï¼ˆåˆå¹¶ã€æ‹†åˆ†ã€æ”¹å†™ï¼‰åªåœ¨æ®µè½å†…è¿›è¡Œï¼Œè·¨æ®µè½åˆå¹¶ä¸ç¬¦åˆå­¦æœ¯å†™ä½œé€»è¾‘ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2 å¤„ç†æµç¨‹ Processing Flow                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Step 4.0: å…¨æ–‡å¥å­è¯†åˆ«ï¼ˆä¸€æ¬¡æ€§ï¼‰                                 â”‚
â”‚     â†“ ç”Ÿæˆ sentences[] + paragraph_sentence_map                  â”‚
â”‚                                                                  â”‚
â”‚  Step 4.1: å…¨æ–‡å¥å¼åˆ†æï¼ˆä¸€æ¬¡æ€§ï¼Œç»Ÿè®¡æ±‡æ€»ï¼‰                       â”‚
â”‚     â†“ è¾“å‡ºå…¨æ–‡ç®€å•å¥æ¯”ä¾‹ã€å¼€å¤´é‡å¤ç‡ç­‰                           â”‚
â”‚     â†“ è¯†åˆ«é«˜é£é™©æ®µè½ high_risk_paragraphs[]                      â”‚
â”‚                                                                  â”‚
â”‚  ç”¨æˆ·é…ç½®é˜¶æ®µ User Configuration Phase                           â”‚
â”‚     â†“ ç”¨æˆ·é€‰æ‹©è¦å¤„ç†çš„æ®µè½ã€è®¾ç½®å¤„ç†ç­–ç•¥                         â”‚
â”‚                                                                  â”‚
â”‚  Step 4.2-4.5: æŒ‰æ®µè½è¿­ä»£å¤„ç†                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ For each paragraph in user_selected_paragraphs:         â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ 4.2 æ®µå†…å¥é•¿åˆ†æ (è¯¥æ®µ)                           â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ 4.3 å¥å­åˆå¹¶å»ºè®® (è¯¥æ®µå†…ç›¸é‚»å¥å­)                 â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ 4.4 è¿æ¥è¯ä¼˜åŒ– (è¯¥æ®µ)                             â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ 4.5 å¤šæ ·åŒ–æ”¹å†™ (è¯¥æ®µ)                             â”‚    â”‚
â”‚  â”‚   â””â”€â”€ ç”¨æˆ·ç¡®è®¤/ç¼–è¾‘/å›é€€ â†’ ä¸‹ä¸€æ®µ                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  å®Œæˆé˜¶æ®µï¼šè®¡ç®—æ”¹è¿›åçš„å…¨æ–‡æŒ‡æ ‡ï¼Œæ˜¾ç¤ºå¯¹æ¯”                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 æŒ‰æ®µè½å¤„ç†çš„ä¼˜åŠ¿ | Advantages of Paragraph-by-Paragraph

| è€ƒè™‘å› ç´  | æŒ‰æ®µè½å¤„ç† | æŒ‰ç« èŠ‚å¤„ç† |
|---------|-----------|-----------|
| **å¥å­åˆå¹¶** | âœ… åªåœ¨æ®µè½å†…åˆå¹¶ï¼Œç¬¦åˆé€»è¾‘ | âŒ è·¨æ®µè½åˆå¹¶ä¸åˆç† |
| **ä¸Šä¸‹æ–‡å¤§å°** | âœ… æ®µè½é€šå¸¸3-8å¥ï¼Œå¯æ§ | âš ï¸ ç« èŠ‚å¯èƒ½æœ‰20+æ®µè½ |
| **ç”¨æˆ·å®¡æ ¸** | âœ… é€æ®µå®¡æ ¸ï¼Œç²’åº¦åˆé€‚ | âŒ æ•´ç« å®¡æ ¸å·¥ä½œé‡å¤§ |
| **ä¸ªæ€§åŒ–å¤„ç†** | âœ… æ¯æ®µå¯è®¾ä¸åŒç­–ç•¥ | âš ï¸ éœ€é¢å¤–é…ç½®æœºåˆ¶ |
| **è¶…é•¿æ–‡æ¡£** | âœ… æ”¯æŒæµå¼å¤„ç† | âš ï¸ å•ç« èŠ‚å¯èƒ½ä»ç„¶å¾ˆé•¿ |
| **è¿›åº¦å¯è§†** | âœ… é€æ®µå®Œæˆï¼Œè¿›åº¦æ¸…æ™° | âš ï¸ æ•´ç« å¤„ç†è¿›åº¦æ¨¡ç³Š |

### 8.4 é«˜é£é™©æ®µè½è¯†åˆ«é€»è¾‘ | High-Risk Paragraph Identification

```python
def identify_high_risk_paragraphs(paragraphs, sentences, para_sent_map):
    """
    Identify paragraphs that need processing based on risk metrics.
    è¯†åˆ«éœ€è¦å¤„ç†çš„é«˜é£é™©æ®µè½ã€‚
    """
    high_risk = []

    for para_idx, sent_indices in para_sent_map.items():
        para_sentences = [sentences[i] for i in sent_indices]

        # Calculate paragraph-level metrics
        # è®¡ç®—æ®µè½çº§æŒ‡æ ‡
        simple_ratio = count_simple_sentences(para_sentences) / len(para_sentences)
        length_cv = calculate_length_cv(para_sentences)
        opener_repetition = calculate_opener_repetition(para_sentences)
        connector_ratio = count_explicit_connectors(para_sentences) / len(para_sentences)

        # Risk scoring
        # é£é™©è¯„åˆ†
        risk_score = 0
        if simple_ratio > 0.6:
            risk_score += 30
        if length_cv < 0.25:
            risk_score += 25
        if opener_repetition > 0.3:
            risk_score += 25
        if connector_ratio > 0.4:
            risk_score += 20

        # Classify risk level
        # é£é™©ç­‰çº§åˆ†ç±»
        if risk_score >= 50:
            risk_level = "high"
        elif risk_score >= 25:
            risk_level = "medium"
        else:
            risk_level = "low"

        high_risk.append({
            "paragraph_index": para_idx,
            "risk_score": risk_score,
            "risk_level": risk_level,
            "issues": [...],  # Specific issues detected
        })

    # Sort by risk score descending
    # æŒ‰é£é™©åˆ†æ•°é™åºæ’åˆ—
    return sorted(high_risk, key=lambda x: x["risk_score"], reverse=True)
```

---

## ä¹ã€ç”¨æˆ·ä¸ªæ€§åŒ–å¤„ç†è®¾è®¡ | User Personalization Design

### 9.1 ç”¨æˆ·éœ€æ±‚åœºæ™¯ | User Requirement Scenarios

| åœºæ™¯ Scenario | ç”¨æˆ·éœ€æ±‚ User Need | è®¾è®¡å“åº” Design Response |
|--------------|-------------------|------------------------|
| **è·³è¿‡æ®µè½** | "è¿™æ®µå¼•ç”¨åŸæ–‡ï¼Œä¸è¦æ”¹" | é”å®š/è·³è¿‡åŠŸèƒ½ |
| **éƒ¨åˆ†æ“ä½œ** | "è¿™æ®µåªåˆå¹¶ï¼Œä¸æ”¹å¼€å¤´" | é€‰æ‹©æ€§æ­¥éª¤åº”ç”¨ |
| **è‡ªå®šä¹‰ç­–ç•¥** | "è¿™æ®µå¤šç”¨è¢«åŠ¨å¥" | æ®µè½çº§å‚æ•°è¦†ç›– |
| **å›é€€ä¿®æ”¹** | "åˆšæ‰é‚£æ®µæ”¹å¾—ä¸å¥½" | ç‰ˆæœ¬å†å²/æ’¤é”€åŠŸèƒ½ |
| **ä¼˜å…ˆçº§è°ƒæ•´** | "å…ˆå¤„ç†ç»“è®ºæ®µ" | è‡ªå®šä¹‰å¤„ç†é¡ºåº |
| **æ‰¹é‡æ“ä½œ** | "æ‰€æœ‰æ–¹æ³•æ®µè½ç”¨åŒæ ·ç­–ç•¥" | æ‰¹é‡é…ç½®/æ¨¡æ¿ |

### 9.2 æ®µè½å¤„ç†æ§åˆ¶å° UI | Paragraph Processing Console UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: å¥å­çº§åˆ†æ - æ®µè½å¤„ç†æ§åˆ¶å°                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚ ğŸ“Š å…¨æ–‡æ¦‚è§ˆ (Step 4.0-4.1)                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ç®€å•å¥: 62% âš ï¸ | å¥é•¿CV: 0.22 âš ï¸ | è¿æ¥è¯: 42% âš ï¸         â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“ æ®µè½å¤„ç†é˜Ÿåˆ— (å¯æ‹–æ‹½æ’åºã€æ‰¹é‡æ“ä½œ)                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ [â˜‘] [â‰¡] Para 1 (Intro)    â”‚ High  â”‚ âš™ï¸ [è‡ªåŠ¨] â–¼ â”‚ [â–¶å¼€å§‹] â”‚    â”‚
â”‚ â”‚ [â˜‘] [â‰¡] Para 2 (LitRev)   â”‚ Med   â”‚ âš™ï¸ [è‡ªåŠ¨] â–¼ â”‚ [å¾…å¤„ç†]â”‚    â”‚
â”‚ â”‚ [â˜] [â‰¡] Para 3 (Method)   â”‚ High  â”‚ ğŸ”’ è·³è¿‡     â”‚ [å·²é”å®š]â”‚    â”‚
â”‚ â”‚ [â˜‘] [â‰¡] Para 4 (Results)  â”‚ Low   â”‚ âš™ï¸ [ä»…åˆå¹¶]â–¼â”‚ [å¾…å¤„ç†]â”‚    â”‚
â”‚ â”‚ [â˜‘] [â‰¡] Para 5 (Discuss)  â”‚ Med   â”‚ âš™ï¸ [è‡ªå®šä¹‰]â–¼â”‚ [å¾…å¤„ç†]â”‚    â”‚
â”‚ â”‚ [â˜‘] [â‰¡] Para 6 (Conclus)  â”‚ High  â”‚ âš™ï¸ [è‡ªåŠ¨] â–¼ â”‚ [âœ“å®Œæˆ] â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚ æ‰¹é‡æ“ä½œ: [å…¨é€‰] [åé€‰] [æ‰¹é‡é”å®š] [æ‰¹é‡è®¾ç½®ç­–ç•¥...]              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 æ®µè½å¤„ç†ç­–ç•¥é…ç½® | Paragraph Processing Strategy Config

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš™ï¸ æ®µè½å¤„ç†ç­–ç•¥ - Para 5 (Discussion)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ å¤„ç†æ¨¡å¼ Processing Mode:                                    â”‚
â”‚ â—‹ è‡ªåŠ¨ (åº”ç”¨æ‰€æœ‰ä¼˜åŒ–)                                        â”‚
â”‚ â—‹ ä»…åˆå¹¶å¥å­ (Step 4.3)                                      â”‚
â”‚ â—‹ ä»…ä¼˜åŒ–è¿æ¥è¯ (Step 4.4)                                    â”‚
â”‚ â—‹ ä»…å¤šæ ·åŒ–æ”¹å†™ (Step 4.5)                                    â”‚
â”‚ â— è‡ªå®šä¹‰é€‰æ‹©...                                              â”‚
â”‚                                                              â”‚
â”‚ è‡ªå®šä¹‰æ­¥éª¤ Custom Steps:                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ [â˜‘] Step 4.2 å¥é•¿åˆ†æ                               â”‚     â”‚
â”‚ â”‚ [â˜‘] Step 4.3 å¥å­åˆå¹¶                               â”‚     â”‚
â”‚ â”‚ [â˜] Step 4.4 è¿æ¥è¯ä¼˜åŒ–  â† ç”¨æˆ·é€‰æ‹©è·³è¿‡             â”‚     â”‚
â”‚ â”‚ [â˜‘] Step 4.5 å¤šæ ·åŒ–æ”¹å†™                             â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚ æ®µè½ç‰¹å®šå‚æ•° Paragraph-specific Parameters:                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ç›®æ ‡è¢«åŠ¨å¥æ¯”ä¾‹: [====â—====] 25% (é»˜è®¤15-30%)        â”‚     â”‚
â”‚ â”‚ å…è®¸å¥å­åˆå¹¶:   [â˜‘] æ˜¯                              â”‚     â”‚
â”‚ â”‚ æœ€å¤§åˆå¹¶å¥æ•°:   [2] â–¼ (2-4å¥)                       â”‚     â”‚
â”‚ â”‚ ä¿ç•™è¿æ¥è¯:     [Furthermore, However] + æ·»åŠ        â”‚     â”‚
â”‚ â”‚ æ”¹å†™æ¿€è¿›ç¨‹åº¦:   [ä¿å®ˆ â—‹ â— â—‹ â—‹ æ¿€è¿›]                 â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚ [æ¢å¤é»˜è®¤] [åº”ç”¨åˆ°ç›¸ä¼¼æ®µè½] [ä¿å­˜ä¸ºæ¨¡æ¿]                      â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.4 å•æ®µè½å¤„ç†ç•Œé¢ï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰| Single Paragraph Processing UI (Version Control)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤„ç†ä¸­: Para 5 (Discussion) - 8å¥                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚ ç‰ˆæœ¬å†å² Version History:                    [â†© æ’¤é”€] [â†ª é‡åš]  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ â— v3 (å½“å‰) - Step 4.5 æ”¹å†™å                            â”‚    â”‚
â”‚ â”‚ â—‹ v2 - Step 4.3 åˆå¹¶å                                   â”‚    â”‚
â”‚ â”‚ â—‹ v1 - Step 4.2 åˆ†æå                                   â”‚    â”‚
â”‚ â”‚ â—‹ v0 - åŸæ–‡                                              â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚ å½“å‰æ”¹å†™é¢„è§ˆ Current Preview:                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ åŸæ–‡ Original:                                           â”‚    â”‚
â”‚ â”‚ "The results indicate a strong correlation. Furthermore, â”‚    â”‚
â”‚ â”‚ the data suggests significant implications. The findings â”‚    â”‚
â”‚ â”‚ are consistent with previous research."                  â”‚    â”‚
â”‚ â”‚                                                          â”‚    â”‚
â”‚ â”‚ æ”¹å†™ Rewritten:                                          â”‚    â”‚
â”‚ â”‚ "Indicating a strong correlation, the results align with â”‚    â”‚
â”‚ â”‚ previous research while suggesting significant           â”‚    â”‚
â”‚ â”‚ implications for future studies."                        â”‚    â”‚
â”‚ â”‚                                                          â”‚    â”‚
â”‚ â”‚ ğŸ“Š æ”¹è¿›: 3å¥â†’2å¥ | ç§»é™¤Furthermore | +1å¤æ‚å¥            â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚ æ“ä½œ Actions:                                                    â”‚
â”‚ [âœ“ æ¥å—æ”¹å†™] [âœ æ‰‹åŠ¨ç¼–è¾‘] [â†© å›é€€åˆ°v2] [ğŸ”„ é‡æ–°ç”Ÿæˆ] [â­ è·³è¿‡]    â”‚
â”‚                                                                  â”‚
â”‚ [â† ä¸Šä¸€æ®µ] [æŸ¥çœ‹å…¨æ–‡é¢„è§ˆ] [ä¸‹ä¸€æ®µ â†’]                              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.5 æ•°æ®ç»“æ„è®¾è®¡ | Data Structure Design

```python
class ParagraphProcessingConfig(BaseModel):
    """
    Configuration for processing each paragraph.
    æ¯ä¸ªæ®µè½çš„å¤„ç†é…ç½®ã€‚
    """
    paragraph_index: int

    # Processing status / å¤„ç†çŠ¶æ€
    status: Literal["pending", "in_progress", "completed", "skipped", "locked"]

    # Processing mode / å¤„ç†æ¨¡å¼
    mode: Literal["auto", "merge_only", "connector_only", "diversify_only", "custom"]

    # Custom step selection / è‡ªå®šä¹‰æ­¥éª¤é€‰æ‹©
    enabled_steps: List[str]  # ["step4-2", "step4-3", "step4-5"]

    # Paragraph-specific parameters / æ®µè½ç‰¹å®šå‚æ•°
    params: ParagraphParams

    # Version history / ç‰ˆæœ¬å†å²
    versions: List[ParagraphVersion]
    current_version: int


class ParagraphParams(BaseModel):
    """
    Paragraph-level parameter overrides.
    æ®µè½çº§å‚æ•°è¦†ç›–ã€‚
    """
    target_passive_ratio: Optional[float] = None  # Override default 0.15-0.30
    allow_merge: bool = True
    max_merge_count: int = 2  # Maximum sentences to merge
    preserve_connectors: List[str] = []  # Connectors to keep
    rewrite_intensity: Literal["conservative", "moderate", "aggressive"] = "moderate"


class ParagraphVersion(BaseModel):
    """
    Version record for paragraph edits.
    æ®µè½ç¼–è¾‘çš„ç‰ˆæœ¬è®°å½•ã€‚
    """
    version: int
    step: str  # Step that produced this version
    text: str
    timestamp: datetime
    changes: List[ChangeRecord]
    metrics: ParagraphMetrics  # Metrics after this version


class ChangeRecord(BaseModel):
    """
    Record of a single change.
    å•ä¸ªä¿®æ”¹çš„è®°å½•ã€‚
    """
    sentence_index: int
    change_type: Literal["merge", "split", "rewrite", "connector_remove", "opener_change"]
    original: str
    modified: str
    reason: str
```

### 9.6 æ®µè½çº§å¤„ç†API | Paragraph-Level Processing API

```python
# Paragraph configuration endpoints
# æ®µè½é…ç½®ç«¯ç‚¹
POST /api/v1/analysis/sentence/paragraph/{para_idx}/config
    # Set processing config for a single paragraph
    # è®¾ç½®å•ä¸ªæ®µè½çš„å¤„ç†é…ç½®

GET /api/v1/analysis/sentence/paragraph/{para_idx}/config
    # Get current config for a paragraph
    # è·å–æ®µè½çš„å½“å‰é…ç½®

# Paragraph processing endpoints
# æ®µè½å¤„ç†ç«¯ç‚¹
POST /api/v1/analysis/sentence/paragraph/{para_idx}/process
    # Process a single paragraph according to its config
    # æ ¹æ®é…ç½®å¤„ç†å•ä¸ªæ®µè½

POST /api/v1/analysis/sentence/paragraph/{para_idx}/revert
    # Revert to a specific version
    # å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬
    Request: { "target_version": 2 }

POST /api/v1/analysis/sentence/paragraph/{para_idx}/regenerate
    # Regenerate with different parameters
    # ä½¿ç”¨ä¸åŒå‚æ•°é‡æ–°ç”Ÿæˆ

# Version management endpoints
# ç‰ˆæœ¬ç®¡ç†ç«¯ç‚¹
GET /api/v1/analysis/sentence/paragraph/{para_idx}/versions
    # Get version history for a paragraph
    # è·å–æ®µè½çš„ç‰ˆæœ¬å†å²

# Batch operations endpoints
# æ‰¹é‡æ“ä½œç«¯ç‚¹
POST /api/v1/analysis/sentence/batch/config
    # Set config for multiple paragraphs
    # æ‰¹é‡è®¾ç½®å¤šä¸ªæ®µè½çš„é…ç½®
    Request: { "paragraph_indices": [1, 3, 5], "config": {...} }

POST /api/v1/analysis/sentence/batch/lock
    # Lock/unlock multiple paragraphs
    # æ‰¹é‡é”å®š/è§£é”æ®µè½
    Request: { "paragraph_indices": [2, 4], "locked": true }
```

### 9.7 å®Œæ•´å¤„ç†æµç¨‹ | Complete Processing Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Layer 2 æ®µè½çº§å¤„ç†æµç¨‹                         â”‚
â”‚                    Paragraph-Level Processing Flow                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚  â”‚ Step 4.0-4.1 â”‚  å…¨æ–‡åˆ†æï¼ˆä¸€æ¬¡æ€§ï¼‰                            â”‚
â”‚  â”‚ å…¨æ–‡å¥å­è¯†åˆ«  â”‚  Generate paragraph risk list                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚         â†“                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç”¨æˆ·é…ç½®é˜¶æ®µ User Configuration Phase                     â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â€¢ æŸ¥çœ‹æ‰€æœ‰æ®µè½é£é™©ç­‰çº§ View all paragraph risk levels   â”‚   â”‚
â”‚  â”‚  â€¢ é€‰æ‹©è¦å¤„ç†çš„æ®µè½ Select paragraphs to process         â”‚   â”‚
â”‚  â”‚  â€¢ è°ƒæ•´å¤„ç†é¡ºåº Adjust processing order (drag & drop)    â”‚   â”‚
â”‚  â”‚  â€¢ ä¸ºæ¯ä¸ªæ®µè½è®¾ç½®å¤„ç†ç­–ç•¥ Set strategy per paragraph     â”‚   â”‚
â”‚  â”‚  â€¢ æ‰¹é‡åº”ç”¨æ¨¡æ¿ Apply templates in batch                 â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ®µè½å¤„ç†å¾ªç¯ Paragraph Processing Loop                    â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  For para in user_selected_order:                        â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚    â”‚ if para.status == "locked":                     â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     skip â†’ next paragraph                       â”‚   â”‚   â”‚
â”‚  â”‚    â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ config = para.config                            â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ save_version(para, "v0-original")               â”‚   â”‚   â”‚
â”‚  â”‚    â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ if "step4-2" in config.enabled_steps:           â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     result = analyze_length(para)               â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     save_version(para, "v1-length")             â”‚   â”‚   â”‚
â”‚  â”‚    â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ if "step4-3" in config.enabled_steps:           â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     result = merge_sentences(para, config)      â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     save_version(para, "v2-merge")              â”‚   â”‚   â”‚
â”‚  â”‚    â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ if "step4-4" in config.enabled_steps:           â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     result = optimize_connectors(para)          â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     save_version(para, "v3-connector")          â”‚   â”‚   â”‚
â”‚  â”‚    â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ if "step4-5" in config.enabled_steps:           â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     result = diversify(para, config)            â”‚   â”‚   â”‚
â”‚  â”‚    â”‚     save_version(para, "v4-diversify")          â”‚   â”‚   â”‚
â”‚  â”‚    â”‚                                                 â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ å±•ç¤ºç»“æœï¼Œç­‰å¾…ç”¨æˆ·æ“ä½œ:                          â”‚   â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ æ¥å— Accept â†’ next paragraph                â”‚   â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ ç¼–è¾‘ Edit â†’ manual edit, then next          â”‚   â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ å›é€€ Revert â†’ restore previous version      â”‚   â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ é‡æ–°ç”Ÿæˆ Regenerate â†’ reprocess             â”‚   â”‚   â”‚
â”‚  â”‚    â”‚   â€¢ è·³è¿‡ Skip â†’ keep original, next             â”‚   â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å®Œæˆé˜¶æ®µ Completion Phase                                â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â€¢ æ˜¾ç¤ºæ”¹è¿›å‰åå¯¹æ¯” Show before/after comparison         â”‚   â”‚
â”‚  â”‚  â€¢ å…¨æ–‡é¢„è§ˆ Full document preview                        â”‚   â”‚
â”‚  â”‚  â€¢ å¯¼å‡ºä¿®æ”¹åçš„æ–‡æ¡£ Export modified document             â”‚   â”‚
â”‚  â”‚  â€¢ ä¼ é€’ä¸Šä¸‹æ–‡åˆ° Layer 1 Pass context to Layer 1         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åã€å®ç°ä¼˜å…ˆçº§ | Implementation Priority

| ä¼˜å…ˆçº§ Priority | å­æ­¥éª¤ Sub-Step | åŸå›  Reason |
|----------------|----------------|-------------|
| **P0** | Step 4.0 å¥å­è¯†åˆ« | åŸºç¡€æ­¥éª¤ï¼Œæ‰€æœ‰åç»­æ­¥éª¤ä¾èµ– |
| **P0** | æ®µè½å¤„ç†æ§åˆ¶å° UI | ç”¨æˆ·é…ç½®å…¥å£ï¼Œæ ¸å¿ƒäº¤äº’ |
| **P1** | Step 4.1 å¥å¼ç»“æ„åˆ†æ | æ ¸å¿ƒæ£€æµ‹ï¼Œç”¨æˆ·æ„ŸçŸ¥å¼º |
| **P1** | Step 4.2 æ®µå†…å¥é•¿åˆ†æ | ä¸Layer 3å…³è”ï¼Œæ•°æ®å¯å¤ç”¨ |
| **P1** | æ®µè½ç‰ˆæœ¬ç®¡ç† | æ”¯æŒæ’¤é”€/å›é€€ |
| **P2** | Step 4.4 è¿æ¥è¯ä¼˜åŒ– | è§„åˆ™æ˜ç¡®ï¼Œå®ç°ç®€å• |
| **P2** | Step 4.3 å¥å­åˆå¹¶ | éœ€è¦LLMæ”¯æŒï¼Œå¤æ‚åº¦é«˜ |
| **P2** | æ®µè½çº§é…ç½®API | æ”¯æŒä¸ªæ€§åŒ–å¤„ç† |
| **P3** | Step 4.5 å¤šæ ·åŒ–æ”¹å†™ | ç»¼åˆæ­¥éª¤ï¼Œä¾èµ–å‰é¢æ‰€æœ‰æ­¥éª¤ |
| **P3** | æ‰¹é‡æ“ä½œ/æ¨¡æ¿ | é«˜çº§åŠŸèƒ½ |

---

## åä¸€ã€å‰ç«¯ç»„ä»¶è®¾è®¡ | Frontend Component Design

### 11.1 é¡µé¢ç»„ä»¶è§„åˆ’ | Page Components

```
frontend/src/pages/layers/
â”œâ”€â”€ LayerStep4_0.tsx    # å¥å­è¯†åˆ«ä¸æ ‡æ³¨ (å…¨æ–‡)
â”œâ”€â”€ LayerStep4_1.tsx    # å¥å¼ç»“æ„åˆ†æ (å…¨æ–‡æ¦‚è§ˆ)
â”œâ”€â”€ LayerStep4_Console.tsx   # æ®µè½å¤„ç†æ§åˆ¶å° (æ–°å¢ - æ ¸å¿ƒ)
â”œâ”€â”€ LayerStep4_Process.tsx   # å•æ®µè½å¤„ç†ç•Œé¢ (æ–°å¢)
â”œâ”€â”€ LayerStep4_2.tsx    # æ®µå†…å¥é•¿åˆ†æ (æ®µè½çº§)
â”œâ”€â”€ LayerStep4_3.tsx    # å¥å­åˆå¹¶å»ºè®® (æ®µè½çº§)
â”œâ”€â”€ LayerStep4_4.tsx    # è¿æ¥è¯ä¼˜åŒ– (æ®µè½çº§)
â”œâ”€â”€ LayerStep4_5.tsx    # å¥å¼å¤šæ ·åŒ–æ”¹å†™ (æ®µè½çº§)
â””â”€â”€ LayerStep4_Complete.tsx  # å®Œæˆ/å¯¹æ¯”ç•Œé¢ (æ–°å¢)
```

### 11.2 å…±äº«ç»„ä»¶ | Shared Components

```
frontend/src/components/layers/
â”œâ”€â”€ SentenceCard.tsx          # å¥å­å¡ç‰‡å±•ç¤º
â”œâ”€â”€ PatternDistribution.tsx   # å¥å¼åˆ†å¸ƒå›¾è¡¨
â”œâ”€â”€ LengthVisualization.tsx   # å¥é•¿å¯è§†åŒ–æ¡
â”œâ”€â”€ MergePreview.tsx          # åˆå¹¶é¢„è§ˆç»„ä»¶
â”œâ”€â”€ ConnectorHighlight.tsx    # è¿æ¥è¯é«˜äº®ç»„ä»¶
â”œâ”€â”€ DiffViewer.tsx            # æ”¹å†™å‰åå¯¹æ¯”ç»„ä»¶
â”œâ”€â”€ ParagraphQueue.tsx        # æ®µè½å¤„ç†é˜Ÿåˆ— (æ–°å¢)
â”œâ”€â”€ ParagraphConfigPanel.tsx  # æ®µè½é…ç½®é¢æ¿ (æ–°å¢)
â”œâ”€â”€ VersionHistory.tsx        # ç‰ˆæœ¬å†å²ç»„ä»¶ (æ–°å¢)
â””â”€â”€ ProcessingProgress.tsx    # å¤„ç†è¿›åº¦ç»„ä»¶ (æ–°å¢)
```

### 11.3 è·¯ç”±è®¾è®¡ | Route Design

```typescript
// App.tsx routes for Layer 2
const layer2Routes = [
  // å…¨æ–‡åˆ†ææ­¥éª¤
  { path: '/flow/layer2-step4-0/:documentId', component: LayerStep4_0 },
  { path: '/flow/layer2-step4-1/:documentId', component: LayerStep4_1 },

  // æ®µè½å¤„ç†æ§åˆ¶å° (é…ç½®é˜¶æ®µ)
  { path: '/flow/layer2-console/:documentId', component: LayerStep4_Console },

  // å•æ®µè½å¤„ç† (è¿­ä»£å¤„ç†)
  { path: '/flow/layer2-process/:documentId/:paragraphIdx', component: LayerStep4_Process },

  // å®Œæˆ/å¯¹æ¯”
  { path: '/flow/layer2-complete/:documentId', component: LayerStep4_Complete },
];
```

---

## åäºŒã€æ€»ç»“ | Summary

æœ¬è®¾è®¡å°†Layer 2çš„å¥å­çº§æ£€æµ‹æ•´åˆä¸º**6ä¸ªæœ‰åºçš„å­æ­¥éª¤**ï¼Œå¹¶é‡‡ç”¨**æŒ‰æ®µè½è¿­ä»£å¤„ç†**çš„ç­–ç•¥ï¼š

### 12.1 å­æ­¥éª¤æ¦‚è§ˆ | Sub-Steps Overview

| æ­¥éª¤ | åç§° | å¤„ç†èŒƒå›´ | è¯´æ˜ |
|------|------|---------|------|
| **Step 4.0** | å¥å­è¯†åˆ«ä¸æ ‡æ³¨ | å…¨æ–‡ä¸€æ¬¡æ€§ | åˆ†å‰²å¹¶æ ‡æ³¨æ‰€æœ‰å¥å­ |
| **Step 4.1** | å¥å¼ç»“æ„åˆ†æ | å…¨æ–‡ä¸€æ¬¡æ€§ | ç”Ÿæˆå…¨å±€ç»Ÿè®¡å’Œé£é™©åˆ—è¡¨ |
| **Console** | æ®µè½å¤„ç†æ§åˆ¶å° | ç”¨æˆ·é…ç½® | é€‰æ‹©æ®µè½ã€è®¾ç½®ç­–ç•¥ |
| **Step 4.2** | æ®µå†…å¥é•¿åˆ†æ | æŒ‰æ®µè½è¿­ä»£ | åˆ†æå¥é•¿åˆ†å¸ƒ |
| **Step 4.3** | å¥å­åˆå¹¶å»ºè®® | æŒ‰æ®µè½è¿­ä»£ | ç”ŸæˆåµŒå¥—ä»å¥ |
| **Step 4.4** | è¿æ¥è¯ä¼˜åŒ– | æŒ‰æ®µè½è¿­ä»£ | æ›¿æ¢æ˜¾æ€§è¿æ¥è¯ |
| **Step 4.5** | å¥å¼å¤šæ ·åŒ–æ”¹å†™ | æŒ‰æ®µè½è¿­ä»£ | LLMç»¼åˆæ”¹å†™ |

### 12.2 æ ¸å¿ƒè®¾è®¡ç†å¿µ | Core Design Philosophy

- **ä¸æ˜¯å­¤ç«‹åˆ†æå•ä¸ªå¥å­**ï¼Œè€Œæ˜¯åœ¨æ®µè½ä¸Šä¸‹æ–‡ä¸­åˆ†æ
- **æŒ‰æ®µè½è¿­ä»£å¤„ç†**ï¼Œæ”¯æŒä»»æ„é•¿åº¦æ–‡æ¡£
- **ç”¨æˆ·ä¸ªæ€§åŒ–æ§åˆ¶**ï¼Œæ¯ä¸ªæ®µè½å¯è®¾ç½®ä¸åŒç­–ç•¥
- **ç‰ˆæœ¬å†å²ç®¡ç†**ï¼Œæ”¯æŒæ’¤é”€/å›é€€/é‡æ–°ç”Ÿæˆ
- **LLMæ·±åº¦ä»‹å…¥**ï¼Œç”Ÿæˆè‡ªç„¶çš„æ”¹å†™ç»“æœ

### 12.3 ç”¨æˆ·ä¸ªæ€§åŒ–åŠŸèƒ½ | User Personalization Features

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **æ®µè½é€‰æ‹©** | å‹¾é€‰è¦å¤„ç†çš„æ®µè½ï¼Œé”å®šä¸å¤„ç†çš„æ®µè½ |
| **å¤„ç†é¡ºåº** | æ‹–æ‹½è°ƒæ•´æ®µè½å¤„ç†é¡ºåº |
| **ç­–ç•¥é…ç½®** | æ¯ä¸ªæ®µè½å¯é€‰æ‹©è‡ªåŠ¨/ä»…åˆå¹¶/ä»…è¿æ¥è¯/è‡ªå®šä¹‰ |
| **å‚æ•°è¦†ç›–** | æ®µè½çº§å‚æ•°ï¼ˆè¢«åŠ¨å¥æ¯”ä¾‹ã€åˆå¹¶æ•°é‡ç­‰ï¼‰ |
| **ç‰ˆæœ¬æ§åˆ¶** | æ¯æ­¥è‡ªåŠ¨ä¿å­˜ç‰ˆæœ¬ï¼Œæ”¯æŒå›é€€ |
| **æ‰¹é‡æ“ä½œ** | æ‰¹é‡é”å®šã€æ‰¹é‡è®¾ç½®ç­–ç•¥ã€æ¨¡æ¿åº”ç”¨ |

### 12.4 é™ä½AIGCæ£€å‡ºç‡çš„å…³é”®æ“ä½œ | Key Operations to Reduce AIGC Detection

1. å¢åŠ å¥å¼å¤šæ ·æ€§ï¼ˆå‡å°‘ç®€å•å¥ï¼Œå¢åŠ å¤æ‚å¥ï¼‰
2. æ‰“ç ´å¥é•¿å‡åŒ€æ€§ï¼ˆåˆå¹¶åˆ›å»ºé•¿å¥ï¼Œæ‹†åˆ†åˆ›å»ºçŸ­å¥ï¼‰
3. ç§»é™¤æ˜¾æ€§è¿æ¥è¯ï¼ˆç”¨è¯­ä¹‰å›å£°æ›¿ä»£ï¼‰
4. å˜æ¢å¥å­å¼€å¤´ï¼ˆå‡å°‘"The/This"å¼€å¤´ï¼‰
5. å¹³è¡¡è¯­æ€ä½¿ç”¨ï¼ˆå¢åŠ è¢«åŠ¨å¥æ¯”ä¾‹ï¼‰

### 12.5 å¤„ç†æµç¨‹ | Processing Flow

```
Step 4.0-4.1 (å…¨æ–‡) â†’ æ§åˆ¶å° (é…ç½®) â†’ æ®µè½å¾ªç¯ (4.2-4.5) â†’ å®Œæˆ (å¯¹æ¯”)
                              â†“
                     ç”¨æˆ·ä¸ºæ¯ä¸ªæ®µè½è®¾ç½®:
                     â€¢ æ˜¯å¦å¤„ç† (é”å®š/è·³è¿‡)
                     â€¢ å¤„ç†ç­–ç•¥ (è‡ªåŠ¨/éƒ¨åˆ†/è‡ªå®šä¹‰)
                     â€¢ å‚æ•°è¦†ç›– (è¢«åŠ¨å¥æ¯”ä¾‹ç­‰)
```

---

> æ–‡æ¡£ç»´æŠ¤ Document Maintenance:
> æœ¬æ–‡æ¡£ä¸ºLayer 2å­æ­¥éª¤ç³»ç»Ÿçš„å”¯ä¸€è®¾è®¡æ–‡æ¡£ï¼Œæ‰€æœ‰ç›¸å…³å˜æ›´éœ€åŒæ­¥æ›´æ–°æ­¤æ–‡ä»¶ã€‚
> This is the sole design document for Layer 2 sub-step system. All related changes must be synced here.
>
> æ›´æ–°å†å² Update History:
> - 2026-01-08 v1.0: åˆå§‹è®¾è®¡ï¼Œ6ä¸ªå­æ­¥éª¤
> - 2026-01-08 v1.1: æ–°å¢é•¿æ–‡æ¡£å¤„ç†ç­–ç•¥ï¼ˆæŒ‰æ®µè½è¿­ä»£ï¼‰ã€ç”¨æˆ·ä¸ªæ€§åŒ–å¤„ç†è®¾è®¡
